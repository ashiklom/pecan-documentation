<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>8 Developer guide | The Predictive Ecosystem Analyzer</title>
  <meta name="description" content="8 Developer guide | The Predictive Ecosystem Analyzer" />
  <meta name="generator" content="bookdown 0.13 and GitBook 2.6.7" />

  <meta property="og:title" content="8 Developer guide | The Predictive Ecosystem Analyzer" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="8 Developer guide | The Predictive Ecosystem Analyzer" />
  
  
  

<meta name="author" content="By: PEcAn Team" />


<meta name="date" content="2019-09-09" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="intermediate-user.html"/>
<link rel="next" href="working-with-vm.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.3/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.6/datatables.js"></script>
<link href="libs/dt-core-1.10.16/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.16/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.16/js/jquery.dataTables.min.js"></script>
<link href="libs/dt-ext-fixedcolumns-1.10.16/css/fixedColumns.dataTables.min.css" rel="stylesheet" />
<script src="libs/dt-ext-fixedcolumns-1.10.16/js/dataTables.fixedColumns.min.js"></script>
<script src="libs/jszip-1.10.16/jszip.min.js"></script>
<script src="libs/pdfmake-1.10.16/pdfmake.min.js"></script>
<script src="libs/pdfmake-1.10.16/vfs_fonts.js"></script>
<link href="libs/dt-ext-buttons-1.10.16/css/buttons.dataTables.min.css" rel="stylesheet" />
<script src="libs/dt-ext-buttons-1.10.16/js/dataTables.buttons.min.js"></script>
<script src="libs/dt-ext-buttons-1.10.16/js/buttons.flash.min.js"></script>
<script src="libs/dt-ext-buttons-1.10.16/js/buttons.html5.min.js"></script>
<script src="libs/dt-ext-buttons-1.10.16/js/buttons.colVis.min.js"></script>
<script src="libs/dt-ext-buttons-1.10.16/js/buttons.print.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a></li>
<li class="part"><span><b>I Introduction</b></span></li>
<li class="chapter" data-level="1" data-path="project-overview.html"><a href="project-overview.html"><i class="fa fa-check"></i><b>1</b> Project Overview</a></li>
<li class="chapter" data-level="2" data-path="contributor-covenant-code-of-conduct.html"><a href="contributor-covenant-code-of-conduct.html"><i class="fa fa-check"></i><b>2</b> Contributor Covenant Code of Conduct</a></li>
<li class="chapter" data-level="3" data-path="about-the-pecan-book.html"><a href="about-the-pecan-book.html"><i class="fa fa-check"></i><b>3</b> About the PEcAn Book</a><ul>
<li class="chapter" data-level="3.1" data-path="about-the-pecan-book.html"><a href="about-the-pecan-book.html#general-feedbackcommentssuggestions"><i class="fa fa-check"></i><b>3.1</b> General Feedback/Comments/Suggestions</a></li>
<li class="chapter" data-level="3.2" data-path="about-the-pecan-book.html"><a href="about-the-pecan-book.html#bookediting"><i class="fa fa-check"></i><b>3.2</b> Editing this book</a></li>
<li class="chapter" data-level="3.3" data-path="about-the-pecan-book.html"><a href="about-the-pecan-book.html#how-to-create-your-own-version-of-documentation"><i class="fa fa-check"></i><b>3.3</b> How to create your own version of Documentation</a></li>
</ul></li>
<li class="part"><span><b>II Tutorials, Demos and How To’s</b></span></li>
<li class="chapter" data-level="4" data-path="pecan-manual-setup.html"><a href="pecan-manual-setup.html"><i class="fa fa-check"></i><b>4</b> Install PEcAn</a><ul>
<li class="chapter" data-level="4.1" data-path="pecan-manual-setup.html"><a href="pecan-manual-setup.html#install-vm"><i class="fa fa-check"></i><b>4.1</b> Virtual Machine (VM)</a></li>
<li class="chapter" data-level="4.2" data-path="pecan-manual-setup.html"><a href="pecan-manual-setup.html#install-docker"><i class="fa fa-check"></i><b>4.2</b> Docker</a></li>
<li class="chapter" data-level="4.3" data-path="pecan-manual-setup.html"><a href="pecan-manual-setup.html#install-native"><i class="fa fa-check"></i><b>4.3</b> (Advanced) Native install</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="user-section.html"><a href="user-section.html"><i class="fa fa-check"></i><b>5</b> User Tutorial Section</a><ul>
<li class="chapter" data-level="5.1" data-path="user-section.html"><a href="user-section.html#how-pecan-works-in-a-nutshell"><i class="fa fa-check"></i><b>5.1</b> How PEcAn Works in a nutshell</a></li>
<li class="chapter" data-level="5.2" data-path="user-section.html"><a href="user-section.html#demo-table"><i class="fa fa-check"></i><b>5.2</b> PEcAn Demos</a></li>
<li class="chapter" data-level="5.3" data-path="user-section.html"><a href="user-section.html#demo-01-basic-run-pecan"><i class="fa fa-check"></i><b>5.3</b> Demo 01: Basic Run PEcAn</a></li>
<li class="chapter" data-level="5.4" data-path="user-section.html"><a href="user-section.html#demo-02-sensitivity-and-uncertainty-analysis"><i class="fa fa-check"></i><b>5.4</b> Demo 02: Sensitivity and Uncertainty Analysis</a></li>
<li class="chapter" data-level="5.5" data-path="user-section.html"><a href="user-section.html#othervignettes"><i class="fa fa-check"></i><b>5.5</b> Other Vignettes</a><ul>
<li class="chapter" data-level="5.5.1" data-path="user-section.html"><a href="user-section.html#simple-model-data-comparisons"><i class="fa fa-check"></i><b>5.5.1</b> Simple Model-Data Comparisons</a></li>
<li class="chapter" data-level="5.5.2" data-path="user-section.html"><a href="user-section.html#data-assimilation-concepts"><i class="fa fa-check"></i><b>5.5.2</b> Data Assimilation Concepts</a></li>
<li class="chapter" data-level="5.5.3" data-path="user-section.html"><a href="user-section.html#parameter-data-assimilation"><i class="fa fa-check"></i><b>5.5.3</b> Parameter Data Assimilation</a></li>
<li class="chapter" data-level="5.5.4" data-path="user-section.html"><a href="user-section.html#state-variable-data-assimilation"><i class="fa fa-check"></i><b>5.5.4</b> State-Variable Data Assimilation</a></li>
<li class="chapter" data-level="5.5.5" data-path="user-section.html"><a href="user-section.html#pecan-testing-the-sensitivity-analysis-against-observations"><i class="fa fa-check"></i><b>5.5.5</b> PEcAn: Testing the Sensitivity Analysis Against Observations&quot;</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="user-section.html"><a href="user-section.html#advanced-user"><i class="fa fa-check"></i><b>5.6</b> Advanced User Guide</a><ul>
<li class="chapter" data-level="5.6.1" data-path="user-section.html"><a href="user-section.html#web-curl-submission"><i class="fa fa-check"></i><b>5.6.1</b> Submitting Workflow from Command Line</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="basic-web-wrokflow.html"><a href="basic-web-wrokflow.html"><i class="fa fa-check"></i><b>6</b> Basic Web workflow</a><ul>
<li class="chapter" data-level="6.1" data-path="basic-web-wrokflow.html"><a href="basic-web-wrokflow.html#web-site-model"><i class="fa fa-check"></i><b>6.1</b> Site and model selection</a><ul>
<li class="chapter" data-level="6.1.1" data-path="basic-web-wrokflow.html"><a href="basic-web-wrokflow.html#selecting-a-model"><i class="fa fa-check"></i><b>6.1.1</b> Selecting a model</a></li>
<li class="chapter" data-level="6.1.2" data-path="basic-web-wrokflow.html"><a href="basic-web-wrokflow.html#selecting-a-site"><i class="fa fa-check"></i><b>6.1.2</b> Selecting a site</a></li>
<li class="chapter" data-level="6.1.3" data-path="basic-web-wrokflow.html"><a href="basic-web-wrokflow.html#site-groups"><i class="fa fa-check"></i><b>6.1.3</b> Site Groups</a></li>
<li class="chapter" data-level="6.1.4" data-path="basic-web-wrokflow.html"><a href="basic-web-wrokflow.html#using-existing-sites"><i class="fa fa-check"></i><b>6.1.4</b> Using existing sites</a></li>
<li class="chapter" data-level="6.1.5" data-path="basic-web-wrokflow.html"><a href="basic-web-wrokflow.html#adding-a-new-site"><i class="fa fa-check"></i><b>6.1.5</b> Adding a new site</a></li>
<li class="chapter" data-level="6.1.6" data-path="basic-web-wrokflow.html"><a href="basic-web-wrokflow.html#troubleshooting"><i class="fa fa-check"></i><b>6.1.6</b> Troubleshooting</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="basic-web-wrokflow.html"><a href="basic-web-wrokflow.html#web-model-config"><i class="fa fa-check"></i><b>6.2</b> Model configuration</a><ul>
<li class="chapter" data-level="6.2.1" data-path="basic-web-wrokflow.html"><a href="basic-web-wrokflow.html#choosing-meteorology"><i class="fa fa-check"></i><b>6.2.1</b> Choosing meteorology</a></li>
<li class="chapter" data-level="6.2.2" data-path="basic-web-wrokflow.html"><a href="basic-web-wrokflow.html#met-workflow"><i class="fa fa-check"></i><b>6.2.2</b> Met workflow</a></li>
<li class="chapter" data-level="6.2.3" data-path="basic-web-wrokflow.html"><a href="basic-web-wrokflow.html#troubleshooting-meteorological-conversions"><i class="fa fa-check"></i><b>6.2.3</b> Troubleshooting meteorological conversions</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="basic-web-wrokflow.html"><a href="basic-web-wrokflow.html#selecting-plant-functional-types-pfts-and-other-parameter-groupings."><i class="fa fa-check"></i><b>6.3</b> Selecting Plant Functional Types (PFTs) and other parameter groupings.</a><ul>
<li class="chapter" data-level="6.3.1" data-path="basic-web-wrokflow.html"><a href="basic-web-wrokflow.html#using-existing-pfts"><i class="fa fa-check"></i><b>6.3.1</b> Using existing PFTs</a></li>
<li class="chapter" data-level="6.3.2" data-path="basic-web-wrokflow.html"><a href="basic-web-wrokflow.html#creating-new-pfts"><i class="fa fa-check"></i><b>6.3.2</b> Creating new PFTs</a></li>
<li class="chapter" data-level="6.3.3" data-path="basic-web-wrokflow.html"><a href="basic-web-wrokflow.html#choosing-initial-vegetation"><i class="fa fa-check"></i><b>6.3.3</b> Choosing initial vegetation</a></li>
<li class="chapter" data-level="6.3.4" data-path="basic-web-wrokflow.html"><a href="basic-web-wrokflow.html#us-fia"><i class="fa fa-check"></i><b>6.3.4</b> US FIA</a></li>
<li class="chapter" data-level="6.3.5" data-path="basic-web-wrokflow.html"><a href="basic-web-wrokflow.html#spin-up"><i class="fa fa-check"></i><b>6.3.5</b> Spin up</a></li>
<li class="chapter" data-level="6.3.6" data-path="basic-web-wrokflow.html"><a href="basic-web-wrokflow.html#selecting-a-soils-product"><i class="fa fa-check"></i><b>6.3.6</b> Selecting a soils product</a></li>
<li class="chapter" data-level="6.3.7" data-path="basic-web-wrokflow.html"><a href="basic-web-wrokflow.html#soil-texture-depth-and-physical-parameters"><i class="fa fa-check"></i><b>6.3.7</b> Soil texture, depth, and physical parameters</a></li>
<li class="chapter" data-level="6.3.8" data-path="basic-web-wrokflow.html"><a href="basic-web-wrokflow.html#other-model-inputs"><i class="fa fa-check"></i><b>6.3.8</b> Other model inputs</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="intermediate-user.html"><a href="intermediate-user.html"><i class="fa fa-check"></i><b>7</b> More on the PEcAn Web Interface</a><ul>
<li class="chapter" data-level="7.1" data-path="intermediate-user.html"><a href="intermediate-user.html#additional-web-configuration"><i class="fa fa-check"></i><b>7.1</b> Additional web configuration</a><ul>
<li class="chapter" data-level="7.1.1" data-path="intermediate-user.html"><a href="intermediate-user.html#intermediate-web-setup"><i class="fa fa-check"></i><b>7.1.1</b> Web interface setup</a></li>
<li class="chapter" data-level="7.1.2" data-path="intermediate-user.html"><a href="intermediate-user.html#browndog"><i class="fa fa-check"></i><b>7.1.2</b> Brown Dog</a></li>
<li class="chapter" data-level="7.1.3" data-path="intermediate-user.html"><a href="intermediate-user.html#intermediate-advanced-setup"><i class="fa fa-check"></i><b>7.1.3</b> Advanced Setup</a></li>
<li class="chapter" data-level="7.1.4" data-path="intermediate-user.html"><a href="intermediate-user.html#intermediate-model-config"><i class="fa fa-check"></i><b>7.1.4</b> Editing model configurations</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="intermediate-user.html"><a href="intermediate-user.html#settings-configured-analyses"><i class="fa fa-check"></i><b>7.2</b> Settings-configured analyses</a><ul>
<li class="chapter" data-level="7.2.1" data-path="intermediate-user.html"><a href="intermediate-user.html#pda"><i class="fa fa-check"></i><b>7.2.1</b> Parameter data assimilation (PDA)</a></li>
<li class="chapter" data-level="7.2.2" data-path="intermediate-user.html"><a href="intermediate-user.html#sda"><i class="fa fa-check"></i><b>7.2.2</b> State data assimilation (SDA)</a></li>
<li class="chapter" data-level="7.2.3" data-path="intermediate-user.html"><a href="intermediate-user.html#running-sda-on-remote"><i class="fa fa-check"></i><b>7.2.3</b> Running SDA on remote</a></li>
<li class="chapter" data-level="7.2.4" data-path="intermediate-user.html"><a href="intermediate-user.html#restart-functionality-in-sda"><i class="fa fa-check"></i><b>7.2.4</b> Restart functionality in SDA</a></li>
<li class="chapter" data-level="7.2.5" data-path="intermediate-user.html"><a href="intermediate-user.html#state-data-assimilation-methods"><i class="fa fa-check"></i><b>7.2.5</b> State Data Assimilation Methods</a></li>
<li class="chapter" data-level="7.2.6" data-path="intermediate-user.html"><a href="intermediate-user.html#multisettings"><i class="fa fa-check"></i><b>7.2.6</b> MultiSettings</a></li>
<li class="chapter" data-level="7.2.7" data-path="intermediate-user.html"><a href="intermediate-user.html#benchmarking"><i class="fa fa-check"></i><b>7.2.7</b> Benchmarking</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="developer-guide.html"><a href="developer-guide.html"><i class="fa fa-check"></i><b>8</b> Developer guide</a><ul>
<li class="chapter" data-level="8.1" data-path="developer-guide.html"><a href="developer-guide.html#updatebety"><i class="fa fa-check"></i><b>8.1</b> Updating PEcAn Code and Bety Database</a><ul>
<li class="chapter" data-level="8.1.1" data-path="developer-guide.html"><a href="developer-guide.html#pecan-make"><i class="fa fa-check"></i><b>8.1.1</b> Updating PEcAn</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="developer-guide.html"><a href="developer-guide.html#pecan-git"><i class="fa fa-check"></i><b>8.2</b> Git and GitHub Workflow</a><ul>
<li class="chapter" data-level="8.2.1" data-path="developer-guide.html"><a href="developer-guide.html#using-git"><i class="fa fa-check"></i><b>8.2.1</b> Using Git</a></li>
<li class="chapter" data-level="8.2.2" data-path="developer-guide.html"><a href="developer-guide.html#github-use-with-pecan"><i class="fa fa-check"></i><b>8.2.2</b> GitHub use with PEcAn</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="developer-guide.html"><a href="developer-guide.html#coding-practices"><i class="fa fa-check"></i><b>8.3</b> Coding Practices</a><ul>
<li class="chapter" data-level="8.3.1" data-path="developer-guide.html"><a href="developer-guide.html#developer-codestyle"><i class="fa fa-check"></i><b>8.3.1</b> Coding Style</a></li>
<li class="chapter" data-level="8.3.2" data-path="developer-guide.html"><a href="developer-guide.html#developer-logging"><i class="fa fa-check"></i><b>8.3.2</b> Logging</a></li>
<li class="chapter" data-level="8.3.3" data-path="developer-guide.html"><a href="developer-guide.html#developer-packagedata"><i class="fa fa-check"></i><b>8.3.3</b> Package Data</a></li>
<li class="chapter" data-level="8.3.4" data-path="developer-guide.html"><a href="developer-guide.html#developer-roxygen"><i class="fa fa-check"></i><b>8.3.4</b> Roxygen2</a></li>
<li class="chapter" data-level="8.3.5" data-path="developer-guide.html"><a href="developer-guide.html#developer-testing"><i class="fa fa-check"></i><b>8.3.5</b> Testing</a></li>
<li class="chapter" data-level="8.3.6" data-path="developer-guide.html"><a href="developer-guide.html#developer-devtools"><i class="fa fa-check"></i><b>8.3.6</b> <code>devtools</code> package</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="developer-guide.html"><a href="developer-guide.html#download-and-compile-pecan"><i class="fa fa-check"></i><b>8.4</b> Download and Compile PEcAn</a><ul>
<li class="chapter" data-level="8.4.1" data-path="developer-guide.html"><a href="developer-guide.html#download-compile-and-install-pecan-from-github"><i class="fa fa-check"></i><b>8.4.1</b> Download, compile and install PEcAn from GitHub</a></li>
<li class="chapter" data-level="8.4.2" data-path="developer-guide.html"><a href="developer-guide.html#pecan-testrun"><i class="fa fa-check"></i><b>8.4.2</b> PEcAn Testrun</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="developer-guide.html"><a href="developer-guide.html#directory-structure"><i class="fa fa-check"></i><b>8.5</b> Directory structure</a><ul>
<li class="chapter" data-level="8.5.1" data-path="developer-guide.html"><a href="developer-guide.html#overview-of-pecan-repository-as-of-pecan-1.5.3"><i class="fa fa-check"></i><b>8.5.1</b> Overview of PEcAn repository as of PEcAn 1.5.3</a></li>
<li class="chapter" data-level="8.5.2" data-path="developer-guide.html"><a href="developer-guide.html#generic-r-package-structure"><i class="fa fa-check"></i><b>8.5.2</b> Generic R package structure:</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Topical Pages</b></span></li>
<li class="chapter" data-level="9" data-path="working-with-vm.html"><a href="working-with-vm.html"><i class="fa fa-check"></i><b>9</b> VM configuration and maintenance</a><ul>
<li class="chapter" data-level="9.1" data-path="working-with-vm.html"><a href="working-with-vm.html#maintain-vm"><i class="fa fa-check"></i><b>9.1</b> Updating the VM</a></li>
<li class="chapter" data-level="9.2" data-path="working-with-vm.html"><a href="working-with-vm.html#ssh-vm"><i class="fa fa-check"></i><b>9.2</b> Connecting to the VM via SSH</a></li>
<li class="chapter" data-level="9.3" data-path="working-with-vm.html"><a href="working-with-vm.html#ssh-vm-bety"><i class="fa fa-check"></i><b>9.3</b> Connecting to bety on the VM via SSh</a><ul>
<li class="chapter" data-level="9.3.1" data-path="working-with-vm.html"><a href="working-with-vm.html#awsvm"><i class="fa fa-check"></i><b>9.3.1</b> Using Amazon Web Services for a VM (AWS)</a></li>
<li class="chapter" data-level="9.3.2" data-path="working-with-vm.html"><a href="working-with-vm.html#createvm"><i class="fa fa-check"></i><b>9.3.2</b> Creating a Virtual Machine</a></li>
<li class="chapter" data-level="9.3.3" data-path="working-with-vm.html"><a href="working-with-vm.html#vm-dektop-conversion"><i class="fa fa-check"></i><b>9.3.3</b> VM Desktop Conversion</a></li>
<li class="chapter" data-level="9.3.4" data-path="working-with-vm.html"><a href="working-with-vm.html#install-rstudio"><i class="fa fa-check"></i><b>9.3.4</b> Install RStudio Desktop</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="pecan-standards.html"><a href="pecan-standards.html"><i class="fa fa-check"></i><b>10</b> PEcAn standard formats</a><ul>
<li class="chapter" data-level="10.1" data-path="pecan-standards.html"><a href="pecan-standards.html#defining-new-input-formats"><i class="fa fa-check"></i><b>10.1</b> Defining new input formats</a></li>
<li class="chapter" data-level="10.2" data-path="pecan-standards.html"><a href="pecan-standards.html#time-standard"><i class="fa fa-check"></i><b>10.2</b> Time Standard</a><ul>
<li class="chapter" data-level="10.2.1" data-path="pecan-standards.html"><a href="pecan-standards.html#input-standards"><i class="fa fa-check"></i><b>10.2.1</b> Input Standards</a></li>
<li class="chapter" data-level="10.2.2" data-path="pecan-standards.html"><a href="pecan-standards.html#soils-and-vegetation-inputs"><i class="fa fa-check"></i><b>10.2.2</b> Soils and Vegetation Inputs</a></li>
<li class="chapter" data-level="10.2.3" data-path="pecan-standards.html"><a href="pecan-standards.html#output-standards"><i class="fa fa-check"></i><b>10.2.3</b> Output Standards</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="pecanXML.html"><a href="pecanXML.html"><i class="fa fa-check"></i><b>11</b> The PEcAn XML</a><ul>
<li class="chapter" data-level="11.0.1" data-path="pecanXML.html"><a href="pecanXML.html#xml-core-config"><i class="fa fa-check"></i><b>11.0.1</b> Core configuration</a></li>
<li class="chapter" data-level="11.0.2" data-path="pecanXML.html"><a href="pecanXML.html#xml-outdir"><i class="fa fa-check"></i><b>11.0.2</b> <code>outdir</code>: Output directory</a></li>
<li class="chapter" data-level="11.0.3" data-path="pecanXML.html"><a href="pecanXML.html#xml-database"><i class="fa fa-check"></i><b>11.0.3</b> <code>database</code>: PEcAn database settings</a></li>
<li class="chapter" data-level="11.0.4" data-path="pecanXML.html"><a href="pecanXML.html#xml-pft"><i class="fa fa-check"></i><b>11.0.4</b> <code>pft</code>: Plant functional type selection</a></li>
<li class="chapter" data-level="11.0.5" data-path="pecanXML.html"><a href="pecanXML.html#xml-meta-analysis"><i class="fa fa-check"></i><b>11.0.5</b> <code>meta.analysis</code>: Trait Meta Analysis</a></li>
<li class="chapter" data-level="11.0.6" data-path="pecanXML.html"><a href="pecanXML.html#xml-model"><i class="fa fa-check"></i><b>11.0.6</b> <code>model</code>: Model configuration</a></li>
<li class="chapter" data-level="11.0.7" data-path="pecanXML.html"><a href="pecanXML.html#xml-run"><i class="fa fa-check"></i><b>11.0.7</b> <code>run</code>: Run Setup</a></li>
<li class="chapter" data-level="11.0.8" data-path="pecanXML.html"><a href="pecanXML.html#xml-host"><i class="fa fa-check"></i><b>11.0.8</b> <code>host</code>: Host information for remote execution</a></li>
<li class="chapter" data-level="11.0.9" data-path="pecanXML.html"><a href="pecanXML.html#xml-advanced"><i class="fa fa-check"></i><b>11.0.9</b> Advanced features</a></li>
<li class="chapter" data-level="11.0.10" data-path="pecanXML.html"><a href="pecanXML.html#xml-ensemble"><i class="fa fa-check"></i><b>11.0.10</b> <code>ensemble</code>: Ensemble Runs</a></li>
<li class="chapter" data-level="11.0.11" data-path="pecanXML.html"><a href="pecanXML.html#xml-sensitivity-analysis"><i class="fa fa-check"></i><b>11.0.11</b> <code>sensitivity.analysis</code>: Sensitivity analysis</a></li>
<li class="chapter" data-level="11.0.12" data-path="pecanXML.html"><a href="pecanXML.html#xml-parameter-data-assimilation"><i class="fa fa-check"></i><b>11.0.12</b> Parameter Data Assimilation</a></li>
<li class="chapter" data-level="11.0.13" data-path="pecanXML.html"><a href="pecanXML.html#xml-multi-settings"><i class="fa fa-check"></i><b>11.0.13</b> Multi-Settings</a></li>
<li class="chapter" data-level="11.0.14" data-path="pecanXML.html"><a href="pecanXML.html#xml-state-data-assimilation"><i class="fa fa-check"></i><b>11.0.14</b> (experimental) State Data Assimilation</a></li>
<li class="chapter" data-level="11.0.15" data-path="pecanXML.html"><a href="pecanXML.html#xml-browndog"><i class="fa fa-check"></i><b>11.0.15</b> (experimental) Brown Dog</a></li>
<li class="chapter" data-level="11.0.16" data-path="pecanXML.html"><a href="pecanXML.html#xml-benchmarking"><i class="fa fa-check"></i><b>11.0.16</b> (experimental) Benchmarking</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="workflow.html"><a href="workflow.html"><i class="fa fa-check"></i><b>12</b> PEcAn workflow (web/workflow.R)</a><ul>
<li class="chapter" data-level="12.0.1" data-path="workflow.html"><a href="workflow.html#workflow-readsettings"><i class="fa fa-check"></i><b>12.0.1</b> Read Settings</a></li>
<li class="chapter" data-level="12.0.2" data-path="workflow.html"><a href="workflow.html#workflow-input"><i class="fa fa-check"></i><b>12.0.2</b> Input Conversions</a></li>
<li class="chapter" data-level="12.0.3" data-path="workflow.html"><a href="workflow.html#workflow-input-data"><i class="fa fa-check"></i><b>12.0.3</b> Input Data</a></li>
<li class="chapter" data-level="12.0.4" data-path="workflow.html"><a href="workflow.html#workflow-input-initial"><i class="fa fa-check"></i><b>12.0.4</b> Initial Conditions</a></li>
<li class="chapter" data-level="12.0.5" data-path="workflow.html"><a href="workflow.html#workflow-met"><i class="fa fa-check"></i><b>12.0.5</b> Meteorological Data</a></li>
<li class="chapter" data-level="12.0.6" data-path="workflow.html"><a href="workflow.html#workflow-met-standard"><i class="fa fa-check"></i><b>12.0.6</b> Converting raw data to PEcAn standard</a></li>
<li class="chapter" data-level="12.0.7" data-path="workflow.html"><a href="workflow.html#workflow-met-downscale"><i class="fa fa-check"></i><b>12.0.7</b> Downscaling and gapfilling (optional)</a></li>
<li class="chapter" data-level="12.0.8" data-path="workflow.html"><a href="workflow.html#workflow-met-model"><i class="fa fa-check"></i><b>12.0.8</b> Converting from PEcAn standard to model-specific format</a></li>
<li class="chapter" data-level="12.0.9" data-path="workflow.html"><a href="workflow.html#workflow-traits"><i class="fa fa-check"></i><b>12.0.9</b> Traits</a></li>
<li class="chapter" data-level="12.0.10" data-path="workflow.html"><a href="workflow.html#workflow-metaanalysis"><i class="fa fa-check"></i><b>12.0.10</b> Meta Analysis</a></li>
<li class="chapter" data-level="12.0.11" data-path="workflow.html"><a href="workflow.html#workflow-modelconfig"><i class="fa fa-check"></i><b>12.0.11</b> Model Configuration</a></li>
<li class="chapter" data-level="12.0.12" data-path="workflow.html"><a href="workflow.html#workflow-modelrun"><i class="fa fa-check"></i><b>12.0.12</b> Run Execution</a></li>
<li class="chapter" data-level="12.0.13" data-path="workflow.html"><a href="workflow.html#workflow-postrun"><i class="fa fa-check"></i><b>12.0.13</b> Post Run Analysis</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="pecan-models.html"><a href="pecan-models.html"><i class="fa fa-check"></i><b>13</b> PEcAn Models</a><ul>
<li class="chapter" data-level="13.0.1" data-path="pecan-models.html"><a href="pecan-models.html#models-biocro"><i class="fa fa-check"></i><b>13.0.1</b> BioCro</a></li>
<li class="chapter" data-level="13.0.2" data-path="pecan-models.html"><a href="pecan-models.html#introduction-1"><i class="fa fa-check"></i><b>13.0.2</b> Introduction</a></li>
<li class="chapter" data-level="13.0.3" data-path="pecan-models.html"><a href="pecan-models.html#pecan-configuration-file-additions"><i class="fa fa-check"></i><b>13.0.3</b> PEcAn configuration file additions</a></li>
<li class="chapter" data-level="13.0.4" data-path="pecan-models.html"><a href="pecan-models.html#model-specific-input-files"><i class="fa fa-check"></i><b>13.0.4</b> Model specific input files</a></li>
<li class="chapter" data-level="13.0.5" data-path="pecan-models.html"><a href="pecan-models.html#model-configuration-files"><i class="fa fa-check"></i><b>13.0.5</b> Model configuration files</a></li>
<li class="chapter" data-level="13.0.6" data-path="pecan-models.html"><a href="pecan-models.html#installation-notes"><i class="fa fa-check"></i><b>13.0.6</b> Installation notes</a></li>
<li class="chapter" data-level="13.0.7" data-path="pecan-models.html"><a href="pecan-models.html#models-clm"><i class="fa fa-check"></i><b>13.0.7</b> CLM</a></li>
<li class="chapter" data-level="13.0.8" data-path="pecan-models.html"><a href="pecan-models.html#models-dalec"><i class="fa fa-check"></i><b>13.0.8</b> DALEC</a></li>
<li class="chapter" data-level="13.0.9" data-path="pecan-models.html"><a href="pecan-models.html#models-ed"><i class="fa fa-check"></i><b>13.0.9</b> ED2</a></li>
<li class="chapter" data-level="13.0.10" data-path="pecan-models.html"><a href="pecan-models.html#models-gday"><i class="fa fa-check"></i><b>13.0.10</b> GDAY</a></li>
<li class="chapter" data-level="13.0.11" data-path="pecan-models.html"><a href="pecan-models.html#models-linkages"><i class="fa fa-check"></i><b>13.0.11</b> LINKAGES</a></li>
<li class="chapter" data-level="13.0.12" data-path="pecan-models.html"><a href="pecan-models.html#models-lpjguess"><i class="fa fa-check"></i><b>13.0.12</b> LPJ-GUESS</a></li>
<li class="chapter" data-level="13.0.13" data-path="pecan-models.html"><a href="pecan-models.html#models-maespa"><i class="fa fa-check"></i><b>13.0.13</b> MAESPA</a></li>
<li class="chapter" data-level="13.0.14" data-path="pecan-models.html"><a href="pecan-models.html#models-preles"><i class="fa fa-check"></i><b>13.0.14</b> PRELES</a></li>
<li class="chapter" data-level="13.0.15" data-path="pecan-models.html"><a href="pecan-models.html#models-sipnet"><i class="fa fa-check"></i><b>13.0.15</b> SiPNET</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="available-meteorological-drivers.html"><a href="available-meteorological-drivers.html"><i class="fa fa-check"></i><b>14</b> Available Meteorological Drivers</a><ul>
<li class="chapter" data-level="14.0.1" data-path="available-meteorological-drivers.html"><a href="available-meteorological-drivers.html#ameriflux"><i class="fa fa-check"></i><b>14.0.1</b> Ameriflux</a></li>
<li class="chapter" data-level="14.0.2" data-path="available-meteorological-drivers.html"><a href="available-meteorological-drivers.html#amerifluxlbl"><i class="fa fa-check"></i><b>14.0.2</b> AmerifluxLBL</a></li>
<li class="chapter" data-level="14.0.3" data-path="available-meteorological-drivers.html"><a href="available-meteorological-drivers.html#fluxnet2015"><i class="fa fa-check"></i><b>14.0.3</b> Fluxnet2015</a></li>
<li class="chapter" data-level="14.0.4" data-path="available-meteorological-drivers.html"><a href="available-meteorological-drivers.html#narr"><i class="fa fa-check"></i><b>14.0.4</b> NARR</a></li>
<li class="chapter" data-level="14.0.5" data-path="available-meteorological-drivers.html"><a href="available-meteorological-drivers.html#cruncep"><i class="fa fa-check"></i><b>14.0.5</b> CRUNCEP</a></li>
<li class="chapter" data-level="14.0.6" data-path="available-meteorological-drivers.html"><a href="available-meteorological-drivers.html#cmip5"><i class="fa fa-check"></i><b>14.0.6</b> CMIP5</a></li>
<li class="chapter" data-level="14.0.7" data-path="available-meteorological-drivers.html"><a href="available-meteorological-drivers.html#nldas"><i class="fa fa-check"></i><b>14.0.7</b> NLDAS</a></li>
<li class="chapter" data-level="14.0.8" data-path="available-meteorological-drivers.html"><a href="available-meteorological-drivers.html#gldas"><i class="fa fa-check"></i><b>14.0.8</b> GLDAS</a></li>
<li class="chapter" data-level="14.0.9" data-path="available-meteorological-drivers.html"><a href="available-meteorological-drivers.html#paleon"><i class="fa fa-check"></i><b>14.0.9</b> PalEON</a></li>
<li class="chapter" data-level="14.0.10" data-path="available-meteorological-drivers.html"><a href="available-meteorological-drivers.html#fluxnetlathuile"><i class="fa fa-check"></i><b>14.0.10</b> FluxnetLaThuile</a></li>
<li class="chapter" data-level="14.0.11" data-path="available-meteorological-drivers.html"><a href="available-meteorological-drivers.html#geostreams"><i class="fa fa-check"></i><b>14.0.11</b> Geostreams</a></li>
<li class="chapter" data-level="14.0.12" data-path="available-meteorological-drivers.html"><a href="available-meteorological-drivers.html#era5"><i class="fa fa-check"></i><b>14.0.12</b> ERA5</a></li>
<li class="chapter" data-level="14.0.13" data-path="available-meteorological-drivers.html"><a href="available-meteorological-drivers.html#download-gfdl"><i class="fa fa-check"></i><b>14.0.13</b> Download GFDL</a></li>
<li class="chapter" data-level="14.0.14" data-path="available-meteorological-drivers.html"><a href="available-meteorological-drivers.html#cm3"><i class="fa fa-check"></i><b>14.0.14</b> CM3</a></li>
<li class="chapter" data-level="14.0.15" data-path="available-meteorological-drivers.html"><a href="available-meteorological-drivers.html#esm2m-esm2g"><i class="fa fa-check"></i><b>14.0.15</b> ESM2M &amp; ESM2G</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="database-synchronization.html"><a href="database-synchronization.html"><i class="fa fa-check"></i><b>15</b> Database synchronization</a><ul>
<li class="chapter" data-level="15.0.1" data-path="database-synchronization.html"><a href="database-synchronization.html#how-does-it-work"><i class="fa fa-check"></i><b>15.0.1</b> How does it work?</a></li>
<li class="chapter" data-level="15.0.2" data-path="database-synchronization.html"><a href="database-synchronization.html#set-up"><i class="fa fa-check"></i><b>15.0.2</b> Set up</a></li>
<li class="chapter" data-level="15.0.3" data-path="database-synchronization.html"><a href="database-synchronization.html#fetch-latest-data"><i class="fa fa-check"></i><b>15.0.3</b> Fetch latest data</a></li>
<li class="chapter" data-level="15.0.4" data-path="database-synchronization.html"><a href="database-synchronization.html#sharing-data"><i class="fa fa-check"></i><b>15.0.4</b> Sharing data</a></li>
<li class="chapter" data-level="15.0.5" data-path="database-synchronization.html"><a href="database-synchronization.html#automation"><i class="fa fa-check"></i><b>15.0.5</b> Automation</a></li>
<li class="chapter" data-level="15.0.6" data-path="database-synchronization.html"><a href="database-synchronization.html#database-maintentance"><i class="fa fa-check"></i><b>15.0.6</b> Database maintentance</a></li>
<li class="chapter" data-level="15.0.7" data-path="database-synchronization.html"><a href="database-synchronization.html#troubleshooting-1"><i class="fa fa-check"></i><b>15.0.7</b> Troubleshooting</a></li>
<li class="chapter" data-level="15.0.8" data-path="database-synchronization.html"><a href="database-synchronization.html#network-status-map"><i class="fa fa-check"></i><b>15.0.8</b> Network Status Map</a></li>
<li class="chapter" data-level="15.0.9" data-path="database-synchronization.html"><a href="database-synchronization.html#tasks"><i class="fa fa-check"></i><b>15.0.9</b> Tasks</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="standalone-tools-modules.html"><a href="standalone-tools-modules.html"><i class="fa fa-check"></i><b>16</b> Standalone tools (modules)</a><ul>
<li class="chapter" data-level="16.0.1" data-path="standalone-tools-modules.html"><a href="standalone-tools-modules.html#LoadData"><i class="fa fa-check"></i><b>16.0.1</b> Loading Data in PEcAn</a></li>
<li class="chapter" data-level="16.0.2" data-path="standalone-tools-modules.html"><a href="standalone-tools-modules.html#function-load_data"><i class="fa fa-check"></i><b>16.0.2</b> Function <code>load_data</code></a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="shiny.html"><a href="shiny.html"><i class="fa fa-check"></i><b>17</b> SHINY</a><ul>
<li class="chapter" data-level="17.0.1" data-path="shiny.html"><a href="shiny.html#debugging-shiny-apps"><i class="fa fa-check"></i><b>17.0.1</b> Debugging Shiny Apps</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="adding-to-pecan.html"><a href="adding-to-pecan.html"><i class="fa fa-check"></i><b>18</b> Adding to PEcAn</a><ul>
<li class="chapter" data-level="18.1" data-path="adding-to-pecan.html"><a href="adding-to-pecan.html#adding-model"><i class="fa fa-check"></i><b>18.1</b> Adding An Ecosystem Model</a></li>
<li class="chapter" data-level="18.2" data-path="adding-to-pecan.html"><a href="adding-to-pecan.html#example-met-conversion-wrapper-function"><i class="fa fa-check"></i><b>18.2</b> Example met conversion wrapper function</a></li>
<li class="chapter" data-level="18.3" data-path="adding-to-pecan.html"><a href="adding-to-pecan.html#NewInput"><i class="fa fa-check"></i><b>18.3</b> Adding input data</a><ul>
<li class="chapter" data-level="18.3.1" data-path="adding-to-pecan.html"><a href="adding-to-pecan.html#meterological-data"><i class="fa fa-check"></i><b>18.3.1</b> Meterological Data</a></li>
<li class="chapter" data-level="18.3.2" data-path="adding-to-pecan.html"><a href="adding-to-pecan.html#vegetation-data-1"><i class="fa fa-check"></i><b>18.3.2</b> Vegetation Data</a></li>
<li class="chapter" data-level="18.3.3" data-path="adding-to-pecan.html"><a href="adding-to-pecan.html#soil-data-1"><i class="fa fa-check"></i><b>18.3.3</b> Soil Data</a></li>
</ul></li>
<li class="chapter" data-level="18.4" data-path="adding-to-pecan.html"><a href="adding-to-pecan.html#adding-data-web"><i class="fa fa-check"></i><b>18.4</b> Pecan Data Ingest via Web Interface</a></li>
<li class="chapter" data-level="18.5" data-path="adding-to-pecan.html"><a href="adding-to-pecan.html#NewFormat"><i class="fa fa-check"></i><b>18.5</b> Creating a new format</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="troubleshooting-and-debugging-pecan.html"><a href="troubleshooting-and-debugging-pecan.html"><i class="fa fa-check"></i><b>19</b> Troubleshooting and Debugging PEcAn</a><ul>
<li class="chapter" data-level="19.0.1" data-path="troubleshooting-and-debugging-pecan.html"><a href="troubleshooting-and-debugging-pecan.html#cookies-and-pecan-web-pages"><i class="fa fa-check"></i><b>19.0.1</b> Cookies and pecan web pages</a></li>
<li class="chapter" data-level="19.0.2" data-path="troubleshooting-and-debugging-pecan.html"><a href="troubleshooting-and-debugging-pecan.html#warning-mkdir-function.mkdir-no-such-file-or-directory"><i class="fa fa-check"></i><b>19.0.2</b> <code>Warning: mkdir() [function.mkdir]: No such file or directory</code></a></li>
<li class="chapter" data-level="19.0.3" data-path="troubleshooting-and-debugging-pecan.html"><a href="troubleshooting-and-debugging-pecan.html#after-creating-a-new-pft-the-tag-for-pft-not-passed-to-config.xml-in-ed"><i class="fa fa-check"></i><b>19.0.3</b> After creating a new PFT the <num> tag for PFT not passed to config.xml in ED</a></li>
<li class="chapter" data-level="19.1" data-path="troubleshooting-and-debugging-pecan.html"><a href="troubleshooting-and-debugging-pecan.html#debugging"><i class="fa fa-check"></i><b>19.1</b> Debugging</a><ul>
<li class="chapter" data-level="19.1.1" data-path="troubleshooting-and-debugging-pecan.html"><a href="troubleshooting-and-debugging-pecan.html#using-testsworkflow.r"><i class="fa fa-check"></i><b>19.1.1</b> Using <code>tests/workflow.R</code></a></li>
<li class="chapter" data-level="19.1.2" data-path="troubleshooting-and-debugging-pecan.html"><a href="troubleshooting-and-debugging-pecan.html#useful-scripts"><i class="fa fa-check"></i><b>19.1.2</b> Useful scripts</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="20" data-path="database.html"><a href="database.html"><i class="fa fa-check"></i><b>20</b> BETY Database Administration</a><ul>
<li class="chapter" data-level="20.0.1" data-path="database.html"><a href="database.html#database-setup"><i class="fa fa-check"></i><b>20.0.1</b> Best practices</a></li>
<li class="chapter" data-level="20.0.2" data-path="database.html"><a href="database.html#backup-of-bety-database"><i class="fa fa-check"></i><b>20.0.2</b> Backup of BETY database</a></li>
<li class="chapter" data-level="20.0.3" data-path="database.html"><a href="database.html#restore-of-bety-database"><i class="fa fa-check"></i><b>20.0.3</b> Restore of BETY database</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="workflow-modules.html"><a href="workflow-modules.html"><i class="fa fa-check"></i><b>21</b> Workflow modules</a><ul>
<li class="chapter" data-level="21.0.1" data-path="workflow-modules.html"><a href="workflow-modules.html#overview-1"><i class="fa fa-check"></i><b>21.0.1</b> Overview</a></li>
<li class="chapter" data-level="21.0.2" data-path="workflow-modules.html"><a href="workflow-modules.html#load-settings"><i class="fa fa-check"></i><b>21.0.2</b> Load Settings:</a></li>
<li class="chapter" data-level="21.0.3" data-path="workflow-modules.html"><a href="workflow-modules.html#query-database"><i class="fa fa-check"></i><b>21.0.3</b> Query Database:</a></li>
<li class="chapter" data-level="21.0.4" data-path="workflow-modules.html"><a href="workflow-modules.html#meta-analysis"><i class="fa fa-check"></i><b>21.0.4</b> Meta Analysis:</a></li>
<li class="chapter" data-level="21.0.5" data-path="workflow-modules.html"><a href="workflow-modules.html#write-configuration-files"><i class="fa fa-check"></i><b>21.0.5</b> Write Configuration Files</a></li>
<li class="chapter" data-level="21.0.6" data-path="workflow-modules.html"><a href="workflow-modules.html#start-runs"><i class="fa fa-check"></i><b>21.0.6</b> Start Runs:</a></li>
<li class="chapter" data-level="21.0.7" data-path="workflow-modules.html"><a href="workflow-modules.html#get-model-output"><i class="fa fa-check"></i><b>21.0.7</b> Get Model Output</a></li>
<li class="chapter" data-level="21.0.8" data-path="workflow-modules.html"><a href="workflow-modules.html#ensemble-analysis"><i class="fa fa-check"></i><b>21.0.8</b> Ensemble Analysis</a></li>
<li class="chapter" data-level="21.0.9" data-path="workflow-modules.html"><a href="workflow-modules.html#sensitivity-analysis-variance-decomposition"><i class="fa fa-check"></i><b>21.0.9</b> Sensitivity Analysis, Variance Decomposition</a></li>
<li class="chapter" data-level="21.0.10" data-path="workflow-modules.html"><a href="workflow-modules.html#glossary"><i class="fa fa-check"></i><b>21.0.10</b> Glossary</a></li>
<li class="chapter" data-level="21.1" data-path="workflow-modules.html"><a href="workflow-modules.html#pecanvm"><i class="fa fa-check"></i><b>21.1</b> PEcAn Virtual Machine</a><ul>
<li class="chapter" data-level="21.1.1" data-path="workflow-modules.html"><a href="workflow-modules.html#aws-setup"><i class="fa fa-check"></i><b>21.1.1</b> AWS Setup</a></li>
<li class="chapter" data-level="21.1.2" data-path="workflow-modules.html"><a href="workflow-modules.html#porting-vm-to-aws"><i class="fa fa-check"></i><b>21.1.2</b> Porting VM to AWS</a></li>
<li class="chapter" data-level="21.1.3" data-path="workflow-modules.html"><a href="workflow-modules.html#set-up-multiple-instances-optional"><i class="fa fa-check"></i><b>21.1.3</b> Set up multiple instances (optional)</a></li>
</ul></li>
<li class="chapter" data-level="21.2" data-path="workflow-modules.html"><a href="workflow-modules.html#shiny-setup"><i class="fa fa-check"></i><b>21.2</b> Shiny Setup</a><ul>
<li class="chapter" data-level="21.2.1" data-path="workflow-modules.html"><a href="workflow-modules.html#install-the-shiny-r-package-and-shiny-server"><i class="fa fa-check"></i><b>21.2.1</b> Install the Shiny R package and Shiny server</a></li>
<li class="chapter" data-level="21.2.2" data-path="workflow-modules.html"><a href="workflow-modules.html#modify-the-shiny-configuration-file"><i class="fa fa-check"></i><b>21.2.2</b> Modify the shiny configuration file</a></li>
<li class="chapter" data-level="21.2.3" data-path="workflow-modules.html"><a href="workflow-modules.html#set-the-apache-proxy"><i class="fa fa-check"></i><b>21.2.3</b> Set the Apache proxy</a></li>
<li class="chapter" data-level="21.2.4" data-path="workflow-modules.html"><a href="workflow-modules.html#enable-and-start-the-shiny-server-and-restart-apache"><i class="fa fa-check"></i><b>21.2.4</b> Enable and start the shiny server, and restart apache</a></li>
<li class="chapter" data-level="21.2.5" data-path="workflow-modules.html"><a href="workflow-modules.html#troubleshooting-2"><i class="fa fa-check"></i><b>21.2.5</b> Troubleshooting</a></li>
<li class="chapter" data-level="21.2.6" data-path="workflow-modules.html"><a href="workflow-modules.html#further-reading"><i class="fa fa-check"></i><b>21.2.6</b> Further reading</a></li>
<li class="chapter" data-level="21.2.7" data-path="workflow-modules.html"><a href="workflow-modules.html#thredds-setup"><i class="fa fa-check"></i><b>21.2.7</b> Thredds Setup</a></li>
<li class="chapter" data-level="21.2.8" data-path="workflow-modules.html"><a href="workflow-modules.html#install-the-tomcat-8-and-thredds-webapp"><i class="fa fa-check"></i><b>21.2.8</b> Install the Tomcat 8 and Thredds webapp</a></li>
<li class="chapter" data-level="21.2.9" data-path="workflow-modules.html"><a href="workflow-modules.html#update-the-catalog"><i class="fa fa-check"></i><b>21.2.9</b> Update the catalog</a></li>
<li class="chapter" data-level="21.2.10" data-path="workflow-modules.html"><a href="workflow-modules.html#troubleshooting-3"><i class="fa fa-check"></i><b>21.2.10</b> Troubleshooting</a></li>
<li class="chapter" data-level="21.2.11" data-path="workflow-modules.html"><a href="workflow-modules.html#further-reading-1"><i class="fa fa-check"></i><b>21.2.11</b> Further reading</a></li>
<li class="chapter" data-level="21.2.12" data-path="workflow-modules.html"><a href="workflow-modules.html#osinstall"><i class="fa fa-check"></i><b>21.2.12</b> OS Specific Installations</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="22" data-path="docker-index.html"><a href="docker-index.html"><i class="fa fa-check"></i><b>22</b> Docker</a><ul>
<li class="chapter" data-level="22.1" data-path="docker-index.html"><a href="docker-index.html#docker-intro"><i class="fa fa-check"></i><b>22.1</b> Introduction to Docker?</a><ul>
<li class="chapter" data-level="22.1.1" data-path="docker-index.html"><a href="docker-index.html#what-is-docker"><i class="fa fa-check"></i><b>22.1.1</b> What is Docker?</a></li>
<li class="chapter" data-level="22.1.2" data-path="docker-index.html"><a href="docker-index.html#working-with-docker"><i class="fa fa-check"></i><b>22.1.2</b> Working with Docker</a></li>
<li class="chapter" data-level="22.1.3" data-path="docker-index.html"><a href="docker-index.html#docker-compose"><i class="fa fa-check"></i><b>22.1.3</b> <code>docker-compose</code></a></li>
</ul></li>
<li class="chapter" data-level="22.2" data-path="docker-index.html"><a href="docker-index.html#docker-quickstart"><i class="fa fa-check"></i><b>22.2</b> The PEcAn docker install process in detail</a><ul>
<li class="chapter" data-level="22.2.1" data-path="docker-index.html"><a href="docker-index.html#pecan-setup-compose-configure"><i class="fa fa-check"></i><b>22.2.1</b> Configure docker-compose</a></li>
<li class="chapter" data-level="22.2.2" data-path="docker-index.html"><a href="docker-index.html#pecan-docker-quickstart-init"><i class="fa fa-check"></i><b>22.2.2</b> Initialize PEcAn (first time only)</a></li>
<li class="chapter" data-level="22.2.3" data-path="docker-index.html"><a href="docker-index.html#docker-quickstart-troubleshooting"><i class="fa fa-check"></i><b>22.2.3</b> Troubleshooting</a></li>
</ul></li>
<li class="chapter" data-level="22.3" data-path="docker-index.html"><a href="docker-index.html#pecan-docker"><i class="fa fa-check"></i><b>22.3</b> PEcAn Docker Architecture</a><ul>
<li class="chapter" data-level="22.3.1" data-path="docker-index.html"><a href="docker-index.html#pecan-docker-overview"><i class="fa fa-check"></i><b>22.3.1</b> Overview</a></li>
<li class="chapter" data-level="22.3.2" data-path="docker-index.html"><a href="docker-index.html#pecan-docker-compose"><i class="fa fa-check"></i><b>22.3.2</b> PEcAn’s <code>docker-compose</code></a></li>
<li class="chapter" data-level="22.3.3" data-path="docker-index.html"><a href="docker-index.html#pecan-dc-structure"><i class="fa fa-check"></i><b>22.3.3</b> Top-level structure</a></li>
<li class="chapter" data-level="22.3.4" data-path="docker-index.html"><a href="docker-index.html#pecan-dc-traefik"><i class="fa fa-check"></i><b>22.3.4</b> <code>traefik</code></a></li>
<li class="chapter" data-level="22.3.5" data-path="docker-index.html"><a href="docker-index.html#pecan-dc-portainer"><i class="fa fa-check"></i><b>22.3.5</b> <code>portainer</code></a></li>
<li class="chapter" data-level="22.3.6" data-path="docker-index.html"><a href="docker-index.html#pecan-dc-minio"><i class="fa fa-check"></i><b>22.3.6</b> <code>minio</code></a></li>
<li class="chapter" data-level="22.3.7" data-path="docker-index.html"><a href="docker-index.html#pecan-dc-thredds"><i class="fa fa-check"></i><b>22.3.7</b> <code>thredds</code></a></li>
<li class="chapter" data-level="22.3.8" data-path="docker-index.html"><a href="docker-index.html#pecan-dc-postgres"><i class="fa fa-check"></i><b>22.3.8</b> <code>postgres</code></a></li>
<li class="chapter" data-level="22.3.9" data-path="docker-index.html"><a href="docker-index.html#pecan-dc-rabbitmq"><i class="fa fa-check"></i><b>22.3.9</b> <code>rabbitmq</code></a></li>
<li class="chapter" data-level="22.3.10" data-path="docker-index.html"><a href="docker-index.html#pecan-dc-bety"><i class="fa fa-check"></i><b>22.3.10</b> <code>bety</code></a></li>
<li class="chapter" data-level="22.3.11" data-path="docker-index.html"><a href="docker-index.html#pecan-dc-docs"><i class="fa fa-check"></i><b>22.3.11</b> <code>docs</code></a></li>
<li class="chapter" data-level="22.3.12" data-path="docker-index.html"><a href="docker-index.html#pecan-dc-web"><i class="fa fa-check"></i><b>22.3.12</b> <code>web</code></a></li>
<li class="chapter" data-level="22.3.13" data-path="docker-index.html"><a href="docker-index.html#pecan-dc-executor"><i class="fa fa-check"></i><b>22.3.13</b> <code>executor</code></a></li>
<li class="chapter" data-level="22.3.14" data-path="docker-index.html"><a href="docker-index.html#pecan-dc-monitor"><i class="fa fa-check"></i><b>22.3.14</b> <code>monitor</code></a></li>
<li class="chapter" data-level="22.3.15" data-path="docker-index.html"><a href="docker-index.html#pecan-dc-models"><i class="fa fa-check"></i><b>22.3.15</b> Model-specific containers</a></li>
</ul></li>
<li class="chapter" data-level="22.4" data-path="docker-index.html"><a href="docker-index.html#model-docker"><i class="fa fa-check"></i><b>22.4</b> Models using Docker</a><ul>
<li class="chapter" data-level="22.4.1" data-path="docker-index.html"><a href="docker-index.html#model-docker-json-file"><i class="fa fa-check"></i><b>22.4.1</b> Model information</a></li>
<li class="chapter" data-level="22.4.2" data-path="docker-index.html"><a href="docker-index.html#model-docker-Dockerfile"><i class="fa fa-check"></i><b>22.4.2</b> Model build</a></li>
<li class="chapter" data-level="22.4.3" data-path="docker-index.html"><a href="docker-index.html#common-docker-problems"><i class="fa fa-check"></i><b>22.4.3</b> Common problems</a></li>
<li class="chapter" data-level="22.4.4" data-path="docker-index.html"><a href="docker-index.html#debugging-missing-libraries"><i class="fa fa-check"></i><b>22.4.4</b> Debugging missing libraries</a></li>
</ul></li>
<li class="chapter" data-level="22.5" data-path="docker-index.html"><a href="docker-index.html#docker-build-images"><i class="fa fa-check"></i><b>22.5</b> Building and modifying images</a><ul>
<li class="chapter" data-level="22.5.1" data-path="docker-index.html"><a href="docker-index.html#docker-local-devel"><i class="fa fa-check"></i><b>22.5.1</b> Local development and testing with Docker</a></li>
</ul></li>
<li class="chapter" data-level="22.6" data-path="docker-index.html"><a href="docker-index.html#docker-troubleshooting"><i class="fa fa-check"></i><b>22.6</b> Troubleshooting Docker</a><ul>
<li class="chapter" data-level="22.6.1" data-path="docker-index.html"><a href="docker-index.html#package-not-available-while-building-images"><i class="fa fa-check"></i><b>22.6.1</b> “Package not available” while building images</a></li>
</ul></li>
<li class="chapter" data-level="22.7" data-path="docker-index.html"><a href="docker-index.html#docker-migrate"><i class="fa fa-check"></i><b>22.7</b> Migrating PEcAn from VM to Docker</a><ul>
<li class="chapter" data-level="22.7.1" data-path="docker-index.html"><a href="docker-index.html#running-bety-as-a-docker-container"><i class="fa fa-check"></i><b>22.7.1</b> Running BETY as a docker container</a></li>
</ul></li>
<li class="chapter" data-level="22.8" data-path="docker-index.html"><a href="docker-index.html#pecan-api"><i class="fa fa-check"></i><b>22.8</b> The PEcAn Docker API</a></li>
<li class="chapter" data-level="22.9" data-path="docker-index.html"><a href="docker-index.html#rabbitmq"><i class="fa fa-check"></i><b>22.9</b> RabbitMQ</a><ul>
<li class="chapter" data-level="22.9.1" data-path="docker-index.html"><a href="docker-index.html#rabbitmq-basics-sender"><i class="fa fa-check"></i><b>22.9.1</b> Producer – <code>sender.py</code></a></li>
<li class="chapter" data-level="22.9.2" data-path="docker-index.html"><a href="docker-index.html#rabbitmq-basics-receiver"><i class="fa fa-check"></i><b>22.9.2</b> Consumer – <code>receiver.py</code></a></li>
<li class="chapter" data-level="22.9.3" data-path="docker-index.html"><a href="docker-index.html#rabbitmq-web"><i class="fa fa-check"></i><b>22.9.3</b> RabbitMQ and the PEcAn web interface</a></li>
<li class="chapter" data-level="22.9.4" data-path="docker-index.html"><a href="docker-index.html#rabbitmq-xml"><i class="fa fa-check"></i><b>22.9.4</b> RabbitMQ in the PEcAn XML</a></li>
<li class="chapter" data-level="22.9.5" data-path="docker-index.html"><a href="docker-index.html#rabbitmq-dockerfile"><i class="fa fa-check"></i><b>22.9.5</b> RabbitMQ configuration in Dockerfiles</a></li>
<li class="chapter" data-level="22.9.6" data-path="docker-index.html"><a href="docker-index.html#rabbitmq-case-study"><i class="fa fa-check"></i><b>22.9.6</b> Case study: PEcAn web interface</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="23" data-path="pecan-remote.html"><a href="pecan-remote.html"><i class="fa fa-check"></i><b>23</b> Remote execution with PEcAn</a><ul>
<li class="chapter" data-level="23.1" data-path="pecan-remote.html"><a href="pecan-remote.html#basics-of-ssh"><i class="fa fa-check"></i><b>23.1</b> Basics of SSH</a></li>
<li class="chapter" data-level="23.2" data-path="pecan-remote.html"><a href="pecan-remote.html#ssh-authentication-password-vs.ssh-key"><i class="fa fa-check"></i><b>23.2</b> SSH authentication – password vs. SSH key</a></li>
<li class="chapter" data-level="23.3" data-path="pecan-remote.html"><a href="pecan-remote.html#ssh-tunneling"><i class="fa fa-check"></i><b>23.3</b> SSH tunneling</a></li>
<li class="chapter" data-level="23.4" data-path="pecan-remote.html"><a href="pecan-remote.html#ssh-tunnels-and-pecan"><i class="fa fa-check"></i><b>23.4</b> SSH tunnels and PEcAn</a></li>
<li class="chapter" data-level="23.5" data-path="pecan-remote.html"><a href="pecan-remote.html#basic-remote-execute-functions"><i class="fa fa-check"></i><b>23.5</b> Basic remote execute functions</a></li>
<li class="chapter" data-level="23.6" data-path="pecan-remote.html"><a href="pecan-remote.html#remote-model-execution-with-pecan"><i class="fa fa-check"></i><b>23.6</b> Remote model execution with PEcAn</a></li>
<li class="chapter" data-level="23.7" data-path="pecan-remote.html"><a href="pecan-remote.html#xml-configuration"><i class="fa fa-check"></i><b>23.7</b> XML configuration</a></li>
<li class="chapter" data-level="23.8" data-path="pecan-remote.html"><a href="pecan-remote.html#configuration-for-pecan-web-interface"><i class="fa fa-check"></i><b>23.8</b> Configuration for PEcAn web interface</a></li>
<li class="chapter" data-level="23.9" data-path="pecan-remote.html"><a href="pecan-remote.html#running-pecan-code-for-remotely"><i class="fa fa-check"></i><b>23.9</b> Running PEcAn code for remotely</a></li>
<li class="chapter" data-level="23.10" data-path="pecan-remote.html"><a href="pecan-remote.html#special-case-geo.bu.edu"><i class="fa fa-check"></i><b>23.10</b> Special case: <code>geo.bu.edu</code></a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="data-assimilation-with-dart.html"><a href="data-assimilation-with-dart.html"><i class="fa fa-check"></i><b>24</b> Data assimilation with DART</a></li>
<li class="part"><span><b>IV Appendix</b></span></li>
<li class="chapter" data-level="25" data-path="miscellaneous.html"><a href="miscellaneous.html"><i class="fa fa-check"></i><b>25</b> Miscellaneous</a><ul>
<li class="chapter" data-level="25.1" data-path="miscellaneous.html"><a href="miscellaneous.html#todo"><i class="fa fa-check"></i><b>25.1</b> TODO</a></li>
<li class="chapter" data-level="25.2" data-path="miscellaneous.html"><a href="miscellaneous.html#using-the-pecan-download.file-function"><i class="fa fa-check"></i><b>25.2</b> Using the PEcAn download.file() function</a></li>
</ul></li>
<li class="chapter" data-level="26" data-path="faq.html"><a href="faq.html"><i class="fa fa-check"></i><b>26</b> FAQ</a></li>
<li class="chapter" data-level="27" data-path="pecan-project-used-in-courses.html"><a href="pecan-project-used-in-courses.html"><i class="fa fa-check"></i><b>27</b> PEcAn Project Used in Courses</a><ul>
<li class="chapter" data-level="27.0.1" data-path="pecan-project-used-in-courses.html"><a href="pecan-project-used-in-courses.html#university-classes"><i class="fa fa-check"></i><b>27.0.1</b> University classes</a></li>
<li class="chapter" data-level="27.0.2" data-path="pecan-project-used-in-courses.html"><a href="pecan-project-used-in-courses.html#summer-courses-workshops"><i class="fa fa-check"></i><b>27.0.2</b> Summer Courses / Workshops</a></li>
<li class="chapter" data-level="27.0.3" data-path="pecan-project-used-in-courses.html"><a href="pecan-project-used-in-courses.html#selected-publications"><i class="fa fa-check"></i><b>27.0.3</b> Selected Publications</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">The Predictive Ecosystem Analyzer</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="developer-guide" class="section level1">
<h1><span class="header-section-number">8</span> Developer guide</h1>
<ul>
<li><a href="developer-guide.html#updatebety">Update BETY</a></li>
<li><a href="developer-guide.html#pecan-make">Update PEcAn Code</a></li>
<li><a href="developer-guide.html#pecan-git">PEcAn and Git</a></li>
<li><a href="developer-guide.html#coding-practices">Coding Practices</a></li>
</ul>

<div id="updatebety" class="section level2">
<h2><span class="header-section-number">8.1</span> Updating PEcAn Code and Bety Database</h2>
<p>Release notes for all releases can be found <a href="https://github.com/PecanProject/pecan/releases">here</a>.</p>
<p>This page will only list any steps you have to do to upgrade an existing system. When updating PEcAn it is highly encouraged to update BETY. You can find instructions on how to do this, as well on how to update the database in the <a href="https://pecan.gitbooks.io/betydb-documentation/content/updating_betydb_when_new_versions_are_released.html">Updating BETYdb</a> gitbook page.</p>
<div id="pecan-make" class="section level3">
<h3><span class="header-section-number">8.1.1</span> Updating PEcAn</h3>
<p>The latest version of PEcAn code can be obtained from the PEcAn repository on GitHub:</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb74-1" data-line-number="1"><span class="bu">cd</span> pecan        # If you are not already in the PEcAn directory</a>
<a class="sourceLine" id="cb74-2" data-line-number="2"><span class="fu">git</span> pull</a></code></pre></div>
<p>The PEcAn build system is based on GNU Make.
The simplest way to install is to run <code>make</code> from inside the PEcAn directory.
This will update the documentation for all packages and install them, as well as all required dependencies.</p>
<p>For more control, the following <code>make</code> commands are available:</p>
<ul>
<li><p><code>make document</code> – Use <code>devtools::document</code> to update the documentation for all package.
Under the hood, this uses the <code>roxygen2</code> documentation system.</p></li>
<li><p><code>make install</code> – Install all packages and their dependnencies using <code>devtools::install</code>.
By default, this only installs packages that have had their code changed and any dependent packages.</p></li>
<li><p><code>make check</code> – Perform a rigorous check of packages using <code>devtools::check</code></p></li>
<li><p><code>make test</code> – Run all unit tests (based on <code>testthat</code> package) for all packages, using <code>devtools::test</code></p></li>
<li><p><code>make clean</code> – Remove the make build cache, which is used to track which packages have changed.
Cache files are stored in the <code>.doc</code>, <code>.install</code>, <code>.check</code>, and <code>.test</code> subdirectories in the PEcAn main directory.
Running <code>make clean</code> will force the next invocation of <code>make</code> commands to operate on all PEcAn packages, regardless of changes.</p></li>
</ul>
<p>The following are some additional <code>make</code> tricks that may be useful:</p>
<ul>
<li><p>Install, check, document, or test a specific package – <code>make .&lt;cmd&gt;/&lt;pkg-dir&gt;</code>; e.g. <code>make .install/utils</code> or <code>make .check/modules/rtm</code></p></li>
<li><p>Force <code>make</code> to run, even if package has not changed – <code>make -B &lt;command&gt;</code></p></li>
<li><p>Run <code>make</code> commands in parallel – <code>make -j&lt;ncores&gt;</code>; e.g. <code>make -j4 install</code> to install packages using four parallel processes.</p></li>
</ul>
<p>All instructions for the <code>make</code> build system are contained in the <code>Makefile</code> in the PEcAn root directory.
For full documentation on <code>make</code>, see the man pages by running <code>man make</code> from a terminal.</p>

</div>
</div>
<div id="pecan-git" class="section level2">
<h2><span class="header-section-number">8.2</span> Git and GitHub Workflow</h2>
<p><span id="using-git">Using Git</span></p>

<div id="using-git" class="section level3">
<h3><span class="header-section-number">8.2.1</span> Using Git</h3>
<p>This document describes the steps required to download PEcAn, make changes to code, and submit your changes.</p>
<ul>
<li>If you are new to GitHub or to PEcAn, start with the one-time set-up instructions under <a href="developer-guide.html#before-any-work-is-done">Before any work is done</a>. Also see the excellent tutorials and references in the <a href="developer-guide.html#git">Git</a>) section right below this list and at the bootom in <a href="developer-guide.html#references">References</a>.</li>
<li>To make trivial changes, see <a href="developer-guide.html#quick-and-easy">Quick and Easy</a>.</li>
<li>To make a few changes to the code, start with the <a href="developer-guide.html#basic-workflow">Basic Workflow</a>.</li>
<li>To make substantial changes and/or if plan to contribute over time see <a href="developer-guide.html#recommended-workflow-a-new-branch-for-each-change">Recommended Workflow: A new branch for each change</a>.</li>
</ul>
<div id="git" class="section level4">
<h4><span class="header-section-number">8.2.1.1</span> Git</h4>
<p>Git is a free &amp; open source, distributed version control system designed
to handle everything from small to very large projects with speed and
efficiency. Every Git clone is a full-fledged repository with complete
history and full revision tracking capabilities, not dependent on
network access or a central server. Branching and merging are fast and
easy to do.</p>
<p>A good place to start is the <a href="https://guides.github.com/introduction/flow/">GitHub 5 minute illustrated tutorial</a>.
In addition, there are three fun tutorials for learning git:</p>
<ul>
<li><a href="https:k//www.codecademy.com/learn/learn-git">Learn Git</a> is a great web-based interactive tutorial.</li>
<li><a href="https://learngitbranching.js.org/">LearnGitBranching</a></li>
<li><a href="http://tryk.github.com">TryGit</a>.</li>
</ul>
<p><strong>URLs</strong> In the rest of the document will use specific URL’s to clone the code.
There a few URL’s you can use to clone a project, using https, ssh and
git. You can use either https or git to clone a repository and write to
it. The git protocol is read-only.
This document describes the steps required to download PEcAn, make changes to code, and submit your changes.</p>
</div>
<div id="pecan-project-and-github" class="section level4">
<h4><span class="header-section-number">8.2.1.2</span> PEcAn Project and Github</h4>
<ul>
<li>Organization Repository: <a href="https://github.com/organizations/PecanProject" class="uri">https://github.com/organizations/PecanProject</a></li>
<li>PEcAn source code: <a href="https://github.com/PecanProject/pecan.git" class="uri">https://github.com/PecanProject/pecan.git</a></li>
<li>BETYdb source code: <a href="https://github.com/PecanProject/bety.git" class="uri">https://github.com/PecanProject/bety.git</a></li>
</ul>
<p>These instructions apply to other repositories too.</p>
</div>
<div id="pecan-project-branches" class="section level4">
<h4><span class="header-section-number">8.2.1.3</span> PEcAn Project Branches</h4>
<p>We follow branch organization laid out on <a href="http://nvie.com/posts/a-successful-git-branching-model">this page</a>.</p>
<p>In short, there are three main branches you must be aware of:</p>
<ul>
<li><strong>develop</strong> - Main Branch containing the latest code. This is the main branch you will make changes to.</li>
<li><strong>master</strong> - Branch containing the latest stable code. DO NOT MAKE CHANGES TO THIS BRANCH.</li>
<li><strong>release/vX.X.X</strong> - Named branches containing code specific to a release. Only make changes to this branch if you are fixing a bug on a release branch.</li>
</ul>
</div>
<div id="milestones-issues-tasks" class="section level4">
<h4><span class="header-section-number">8.2.1.4</span> Milestones, Issues, Tasks</h4>
<p>The Milestones, issues, and tasks can be used to organize specific features or research projects. In general, there is a heirarchy:</p>
<ul>
<li>milestones (Big picture, “Epic”): contains many issues, organized by release.</li>
<li>issues (Specific features / bugs, “Story”): may contain a list of tasks; represent</li>
<li>task list (to do list, “Tasks”): list of steps required to close an issue, e.g.:</li>
</ul>
<table>
<tbody>
<tr class="odd">
<td align="left">* [ ] first do this</td>
</tr>
<tr class="even">
<td align="left">* [ ] then this</td>
</tr>
<tr class="odd">
<td align="left">* [ ] completed when x and y</td>
</tr>
</tbody>
</table>
</div>
<div id="quick-and-easy" class="section level4">
<h4><span class="header-section-number">8.2.1.5</span> Quick and Easy</h4>
<p>The <strong>easiest</strong> approach is to use GitHub’s browser based workflow. This is useful when your change is a few lines, if you are editing a wiki, or if the edit is trivial (and won’t break the code). The <a href="https://help.github.com/articles/github-flow-in-the-browser">GitHub documentation is here</a> but it is simple: finding the page or file you want to edit, click “edit” and then the GitHub web application will automatically forking and branch, then allow you to submit a pull request. However, it should be noted that unless you are a member of the PEcAn project that the “edit” button will not be active and you’ll want to follow the workflow described below for forking and then submitting a pull request.</p>
</div>
<div id="recommended-git-workflow" class="section level4">
<h4><span class="header-section-number">8.2.1.6</span> Recommended Git Workflow</h4>
<p><strong>Each feature should be in its own branch</strong> (for example each issue is a branch, names of branches are often the issue in a bug tracking system).</p>
<p><strong>Commit and Push Frequency</strong> On your branch, commit <strong><em>at minimum once a day before you push changes:</em></strong> even better: every time you reach a stopping point and move to a new issue. best: any time that you have done work that you do not want to re-do. Remember, pushing changes to your branch is like saving a draft. Submit a pull request when you are done.</p>
</div>
<div id="before-any-work-is-done" class="section level4">
<h4><span class="header-section-number">8.2.1.7</span> Before any work is done</h4>
<p>The first step below only needs to be done once when you first start working on the PEcAn code. The steps below that need to be done to set up PEcAn on your computer, and would need to be repeated if you move to a new computer. If you are working from the PEcAn VM, you can skip the “git clone” since the PEcAn code is already installed.</p>
<p>Most people will not be able to work in the PEcAn repository directly and will need to create a fork of the PEcAn source code in their own folder. To fork PEcAn into your own github space (<a href="https://help.github.com/articles/fork-a-repo">github help: “fork a repo”</a>). This forked repository will allow you to create branches and commit changes back to GitHub and create pull requests to the develop branch of PEcAn.</p>
<p>The forked repository is the only way for external people to commit code back to PEcAn and BETY. The pull request will start a review process that will eventually result in the code being merged into the main copy of the codebase. See <a href="https://help.github.com/articles/fork-a-repo" class="uri">https://help.github.com/articles/fork-a-repo</a> for more information, especially on how to keep your fork up to date with respect to the original. (Rstudio users should also see <a href="Using-Git.md#git--rstudio">Git + Rstudio</a>, below)</p>
<p>You can setup SSH keys to make it easier to commit cod back to GitHub. This might especially be true if you are working from a cluster, see <a href="https://help.github.com/articles/generating-ssh-keys">set up ssh keys</a></p>
<ol style="list-style-type: decimal">
<li>Introduce yourself to GIT</li>
</ol>
<p><code>git config --global user.name &quot;FULLNAME&quot;</code>
<code>git config --global user.email you@yourdomain.example.com</code></p>
<ol start="2" style="list-style-type: decimal">
<li><p>Fork PEcAn on GitHub. Go to the PEcAn source code and click on the Fork button in the upper right. This will create a copy of PEcAn in your personal space.</p></li>
<li><p>Clone to your local machine via command line</p></li>
</ol>
<p><code>git clone git@github.com:&lt;username&gt;/pecan.git</code></p>
<p>If this does not work, try the https method</p>
<p><code>git clone https://github.com/PecanProject/pecan.git</code></p>
<ol start="4" style="list-style-type: decimal">
<li>Define upstream repository</li>
</ol>
<pre><code>cd pecan
git remote add upstream git@github.com:PecanProject/pecan.git</code></pre>
</div>
<div id="during-development" class="section level4">
<h4><span class="header-section-number">8.2.1.8</span> During development:</h4>
<ul>
<li>commit often;</li>
<li>each commit can address 0 or 1 issue; many commits can reference an issue</li>
<li>ensure that all tests are passing before anything is pushed into develop.</li>
</ul>
</div>
<div id="basic-workflow" class="section level4">
<h4><span class="header-section-number">8.2.1.9</span> Basic Workflow</h4>
<p>This workflow is for educational purposes only. Please use the Recommended Workflow if you plan on contributing to PEcAn. This workflow does not include creating branches, a feature we would like you to use.
1. Get the latest code from the main repository</p>
<p><code>git pull upstream develop</code></p>
<ol start="2" style="list-style-type: decimal">
<li><p>Do some coding</p></li>
<li><p>Commit after each chunk of code (multiple times a day)</p></li>
</ol>
<p><code>git commit -m &quot;&lt;some descriptive information about what was done; references/fixes gh-X&gt;&quot;</code></p>
<ol start="4" style="list-style-type: decimal">
<li>Push to YOUR Github (when a feature is working, a set of bugs are fixed, or you need to share progress with others)</li>
</ol>
<p><code>git push origin develop</code></p>
<ol start="5" style="list-style-type: decimal">
<li>Before submitting code back to the main repository, make sure that code compiles from the main directory.</li>
</ol>
<p><code>make</code></p>
<ol start="6" style="list-style-type: decimal">
<li>submit pull request with a reference to related issue;</li>
</ol>
<ul>
<li>also see <a href="https://help.github.com/articles/using-pull-requests">github documentation</a></li>
</ul>
</div>
<div id="recommended-workflow-a-new-branch-for-each-change" class="section level4">
<h4><span class="header-section-number">8.2.1.10</span> Recommended Workflow: A new branch for each change</h4>
<ol style="list-style-type: decimal">
<li>Make sure you start in develop</li>
</ol>
<p><code>git checkout develop</code></p>
<ol start="2" style="list-style-type: decimal">
<li>Make sure develop is up to date</li>
</ol>
<p><code>git pull upstream develop</code></p>
<ol start="3" style="list-style-type: decimal">
<li>Run the PEcAn MAKEFILE to compile code from the main directory.</li>
</ol>
<p><code>make</code></p>
<ol start="4" style="list-style-type: decimal">
<li>Create a branch and switch to it</li>
</ol>
<p><code>git checkout -b &lt;branchname&gt;</code></p>
<ol start="5" style="list-style-type: decimal">
<li>Work/commit/etc</li>
</ol>
<p><code>git add &lt;file_that_was_changed.R&gt;</code></p>
<p><code>git commit -m &quot;&lt;some descriptive information about what was done&gt;&quot;</code></p>
<ol start="6" style="list-style-type: decimal">
<li>Make sure that code compiles and documentation updated. The make document command will run roxygenise.</li>
</ol>
<p><code>make document</code>
<code>make</code></p>
<ol start="7" style="list-style-type: decimal">
<li>Push this branch to your github space</li>
</ol>
<p><code>git push origin &lt;branchname&gt;</code></p>
<ol start="8" style="list-style-type: decimal">
<li>submit pull request with [[link commits to issues|Using-Git#link-commits-to-issuess]];</li>
</ol>
<ul>
<li>also see <a href="https://github.com/PecanProject/bety/issues/57">explanation in this PecanProject/bety issue</a> and <a href="https://help.github.com/articles/using-pull-requests">github documentation</a></li>
</ul>
</div>
<div id="after-pull-request-is-merged" class="section level4">
<h4><span class="header-section-number">8.2.1.11</span> After pull request is merged</h4>
<ol style="list-style-type: decimal">
<li>Make sure you start in master</li>
</ol>
<p><code>git checkout develop</code></p>
<ol start="2" style="list-style-type: decimal">
<li>delete branch remotely</li>
</ol>
<p><code>git push origin --delete &lt;branchname&gt;</code></p>
<ol start="3" style="list-style-type: decimal">
<li>delete branch locally</li>
</ol>
<p><code>git branch -D &lt;branchname&gt;</code></p>
</div>
<div id="fixing-a-release-branch" class="section level4">
<h4><span class="header-section-number">8.2.1.12</span> Fixing a release Branch</h4>
<p>If you would like to make changes to a release branch, you must follow a different workflow, as the release branch will not contain the latest code on develop and must remain seperate.</p>
<ol style="list-style-type: decimal">
<li>Fetch upstream remote branches</li>
</ol>
<p><code>git fetch upstream</code></p>
<ol start="2" style="list-style-type: decimal">
<li>Checkout the correct release branch</li>
</ol>
<p><code>git checkout -b release/vX.Y.Z</code></p>
<ol start="4" style="list-style-type: decimal">
<li>Compile Code with make</li>
</ol>
<p><code>make</code></p>
<ol start="5" style="list-style-type: decimal">
<li>Make changes and commit them</li>
</ol>
<p><code>git add &lt;changed_file.R&gt;</code>
<code>git commit -m &quot;Describe changes&quot;</code></p>
<ol start="6" style="list-style-type: decimal">
<li><p>Compile and make roxygen changes
<code>make</code>
<code>make document</code></p></li>
<li><p>Commit and push any files that were changed by make document</p></li>
<li><p>Make a pull request. It is essential that you compare your pull request to the remote release branch, NOT the develop branch.</p></li>
</ol>
</div>
<div id="link-commits-to-issues" class="section level4">
<h4><span class="header-section-number">8.2.1.13</span> Link commits to issues</h4>
<p>You can reference and close issues from comments, pull requests, and commit messages. This should be done when you commit code that is related to or will close/fix an existing issue.</p>
<p>There are two ways to do this. One easy way is to include the following text in your commit message:</p>
<ul>
<li><a href="https://github.com/blog/1386-closing-issues-via-commit-messages"><strong>Github</strong></a></li>
<li>to close: “closes gh-xxx” (or syn. close, closed, fixes, fix, fixed)<br />
</li>
<li>to reference: just the issue number (e.g. “gh-xxx”)</li>
</ul>
</div>
<div id="other-useful-git-commands" class="section level4">
<h4><span class="header-section-number">8.2.1.14</span> Other Useful Git Commands:</h4>
<ul>
<li>GIT encourages branching “early and often”</li>
<li>First pull from develop</li>
<li>Branch before working on feature</li>
<li>One branch per feature</li>
<li>You can switch easily between branches</li>
<li>Merge feature into main line when branch done</li>
</ul>
<p>If during above process you want to work on something else, commit all
your code, create a new branch, and work on new branch.</p>
<ul>
<li>Delete a branch: <code>git branch -d &lt;name of branch&gt;</code></li>
<li>To push a branch git: <code>push -u origin</code><name of branch>`</li>
<li>To check out a branch:</li>
</ul>
<pre><code>git fetch origin
git checkout --track origin/&lt;name of branch&gt;</code></pre>
<ul>
<li>Show graph of commits:</li>
</ul>
<p><code>git log --graph --oneline --all</code></p>
</div>
<div id="tags" class="section level4">
<h4><span class="header-section-number">8.2.1.15</span> Tags</h4>
<p>Git supports two types of tags: lightweight and annotated. For more information see the <a href="http://git-scm.com/book/ch2-6.html">Tagging Chapter in the Git documentation</a>.</p>
<p>Lightweight tags are useful, but here we discuss the annotated tags that are used for marking stable versions, major releases, and versions associated with published results.</p>
<p>The basic command is <code>git tag</code>. The <code>-a</code> flag means ‘annotated’ and <code>-m</code> is used before a message. Here is an example:</p>
<p><code>git tag -a v0.6 -m &quot;stable version with foo and bar features, used in the foobar publication by Bob&quot;</code></p>
<p>Adding a tag to the a remote repository must be done explicitly with a push, e.g.</p>
<p><code>git push v0.6</code></p>
<p>To use a tagged version, just checkout:</p>
<p><code>git checkout v0.6</code></p>
<p>To tag an earlier commit, just append the commit SHA to the command, e.g.</p>
<p><code>git tag -a v0.99 -m &quot;last version before 1.0&quot; 9fceb02</code></p>
<p><strong>Using GitHub</strong> The easiest way to get working with GitHub is by installing the GitHub
client. For instructions for your specific OS and download of the
GitHub client, see <a href="https://help.github.com/articles/set-up-git" class="uri">https://help.github.com/articles/set-up-git</a>.
This will help you set up an SSH key to push code back to GitHub. To
check out a project you do not need to have an ssh key and you can use
the https or git url to check out the code.</p>
</div>
<div id="git-rstudio" class="section level4">
<h4><span class="header-section-number">8.2.1.16</span> Git + Rstudio</h4>
<p>Rstudio is nicely integrated with many development tools, including git and GitHub.
It is quite easy to check out source code from within the Rstudio program or browser.
The Rstudio documentation includes useful overviews of <a href="http://www.rstudio.com/ide/docs/version_control/overview">version control</a> and <a href="http://www.rstudio.com/ide/docs/packages/overview">R package development</a>.</p>
<p>Once you have git installed on your computer (see the <a href="http://www.rstudio.com/ide/docs/version_control/overview">Rstudio version control</a> documentation for instructions), you can use the following steps to install the PEcAn source code in Rstudio.</p>
</div>
<div id="creating-a-read-only-version" class="section level4">
<h4><span class="header-section-number">8.2.1.17</span> Creating a Read-only version:</h4>
<p>This is a fast way to clone the repository that does not support contributing new changes (this can be done with further modification).</p>
<ol style="list-style-type: decimal">
<li>install Rstudio (www.rstudio.com)</li>
<li>click (upper right) project</li>
</ol>
<ul>
<li>create project</li>
<li>version control</li>
<li>Git - clone a project from a Git Repository</li>
<li>paste <a href="https://www.github.com/PecanProject/pecan" class="uri">https://www.github.com/PecanProject/pecan</a></li>
<li>choose working dir. for repo</li>
</ul>
</div>
<div id="for-development" class="section level4">
<h4><span class="header-section-number">8.2.1.18</span> For development:</h4>
<ol style="list-style-type: decimal">
<li>create account on github</li>
<li>create a fork of the PEcAn repository to your own account <a href="https://www.github.com/pecanproject/pecan" class="uri">https://www.github.com/pecanproject/pecan</a></li>
<li>install Rstudio (www.rstudio.com)</li>
<li>generate an ssh key</li>
</ol>
<ul>
<li>in Rstudio:
<ul>
<li><code>Tools -&gt; Options -&gt; Git/SVN -&gt; &quot;create RSA key&quot;</code></li>
</ul></li>
<li><code>View public key -&gt; ctrl+C to copy</code></li>
<li>in GitHub</li>
<li>go to <a href="https://github.com/settings/ssh">ssh settings</a></li>
<li><code>-&gt; 'add ssh key' -&gt; ctrl+V to paste -&gt; 'add key'</code></li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>Create project in Rstudio</li>
</ol>
<ul>
<li><code>project (upper right) -&gt; create project -&gt; version control -&gt; Git - clone a project from a Git Repository</code></li>
<li>paste repository url <code>git@github.com:&lt;username&gt;/pecan.git&gt;</code></li>
<li>choose working dir. for repository</li>
</ul>
</div>
<div id="references" class="section level4">
<h4><span class="header-section-number">8.2.1.19</span> References</h4>
</div>
<div id="git-documentation" class="section level4">
<h4><span class="header-section-number">8.2.1.20</span> Git Documentation</h4>
<ul>
<li>Scott Chacon, ‘Pro Git book’,
<a href="http://git-scm.com/book" class="uri">http://git-scm.com/book</a></li>
<li>GitHub help pages,
<a href="https://help.github.com" class="uri">https://help.github.com</a>/</li>
<li>Main GIT page
<a href="http://git-scm.com/documentation" class="uri">http://git-scm.com/documentation</a></li>
<li>Another set of pages about branching,
<a href="http://sandofsky.com/blog/git-workflow.html" class="uri">http://sandofsky.com/blog/git-workflow.html</a></li>
<li><a href="http://stackoverflow.com/questions/tagged/git?sort=votes&amp;pagesize=50">Stackoverflow highest voted questions tagged “git”</a></li>
</ul>
</div>
<div id="github-documentation" class="section level4">
<h4><span class="header-section-number">8.2.1.21</span> GitHub Documentation</h4>
<p>When in doubt, the first step is to click the “Help” button at the top of the page.</p>
<ul>
<li><a href="http://scottchacon.com/2011/08/31/github-flow.html">GitHub Flow</a> by
Scott Chacon (Git evangelist and Ruby developer working on GitHub.com)</li>
<li><a href="https://help.github.com/">GitHub FAQ</a></li>
<li><a href="https://help.github.com/articles/using-pull-requests">Using Pull Requests</a></li>
<li><a href="https://help.github.com/articles/generating-ssh-keys">SSH Keys</a></li>
</ul>

</div>
</div>
<div id="github-use-with-pecan" class="section level3">
<h3><span class="header-section-number">8.2.2</span> GitHub use with PEcAn</h3>
<p>In this section, development topics are introduced and discussed. PEcAn code lives within the If you are looking for an issue to work on, take a look through issues labled <a href="https://github.com/PecanProject/pecan/issues?q=is%3Aopen+is%3Aissue+label%3A%22good+first+issue%22">“good first issue”</a>. To get started you will want to review</p>
<p>We use GitHub to track development.</p>
<p>To learn about GitHub, it is worth taking some time to read through the <a href="https://help.github.com/">FAQ</a>. When in doubt, the first step is to click the “Help” button at the top of the page.</p>
<ul>
<li><strong>To address specific people</strong>, use a github feature called <span class="citation">@mentions</span> e.g. write <span class="citation">@dlebauer</span>, <span class="citation">@robkooper</span>, <span class="citation">@mdietze</span>, or <span class="citation">@serbinsh</span> … in the issue to alert the user as described in the <a href="https://help.github.com/articles/notifications">GitHub documentation on notifications</a></li>
</ul>
<div id="bugs-issues-features-etc." class="section level4">
<h4><span class="header-section-number">8.2.2.1</span> Bugs, Issues, Features, etc.</h4>
</div>
<div id="reporting-a-bug" class="section level4">
<h4><span class="header-section-number">8.2.2.2</span> Reporting a bug</h4>
<ol style="list-style-type: decimal">
<li>(For developers) work through debugging.</li>
<li>Once you have identified a problem, that you can not resolve, you can write a bug report</li>
<li>Write a bug report</li>
<li>submit the bug report</li>
<li>If you do find the answer, explain the resolution (in the issue) and close the issue</li>
</ol>
</div>
<div id="required-content" class="section level4">
<h4><span class="header-section-number">8.2.2.3</span> Required content</h4>
<p>Note:</p>
<ul>
<li><strong>a bug is only a bug if it is reproducible</strong></li>
<li><strong>clear bug reports save time</strong></li>
</ul>
<ol style="list-style-type: decimal">
<li>Clear, specific title</li>
<li>Description -</li>
</ol>
<ul>
<li>What you did</li>
<li>What you expected to happen</li>
<li>What actually happened</li>
<li>What does work, under what conditions does it fail?</li>
<li>Reproduction steps - minimum steps required to reproduce the bug</li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li>additional materials that could help identify the cause:</li>
</ol>
<ul>
<li>screen shots</li>
<li>stack traces, logs, scripts, output</li>
<li>specific code and data / settings / configuration files required to reproduce the bug</li>
<li>environment (operating system, browser, hardware)</li>
</ul>
</div>
<div id="requesting-a-feature" class="section level4">
<h4><span class="header-section-number">8.2.2.4</span> Requesting a feature</h4>
<p>(from The Pragmatic Programmer, available as
<a href="http://proquestcombo.safaribooksonline.com/0-201-61622-X/223">ebook</a>
through UI libraries, hardcopy on David’s bookshelf)<br />
</p>
<ul>
<li>focus on “user stories”, e.g. specific use cases</li>
<li><p>Be as specific as possible,</p></li>
<li><p>Here is an example:</p></li>
</ul>
<ol style="list-style-type: decimal">
<li>Bob is at www.mysite.edu/maps</li>
<li>map of the the region (based on user location, e.g. US, Asia, etc)</li>
<li>option to “use current location” is provided, if clicked, map zooms in to, e.g. state or county level</li>
<li>for site run:
<ol style="list-style-type: decimal">
<li>option to select existing site or specify point by lat/lon</li>
<li>option to specify a bounding box and grid resolution in
either lat/lon or polar stereographic.</li>
</ol></li>
<li>asked to specify start and end times in terms of year, month, day, hour, minute. Time is recorded in UTC not local time, this should be indicated.</li>
</ol>
</div>
<div id="closing-an-issue" class="section level4">
<h4><span class="header-section-number">8.2.2.5</span> Closing an issue</h4>
<ol style="list-style-type: decimal">
<li>Definition of “Done”</li>
</ol>
<ul>
<li>test</li>
<li>documentation</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>when issue is resolved:</li>
</ol>
<ul>
<li>status is changed to “resolved”</li>
<li>assignee is changed to original author</li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li>if original author agrees that issue has been resolved</li>
</ol>
<ul>
<li>original author changes status to “closed”</li>
</ul>
<ol start="4" style="list-style-type: decimal">
<li>except for trivial issues, issues are only closed by the author</li>
</ol>
</div>
<div id="when-to-submit-an-issue" class="section level4">
<h4><span class="header-section-number">8.2.2.6</span> When to submit an issue?</h4>
<p><strong>Ideally, non-trivial code changes will be linked to an issue and a commit.</strong></p>
<p>This requires creating issues for each task, making small commits, and referencing the issue within your commit message. Issues can be created <a href="https://github.com/PecanProject/pecan/issues/new">on GitHub</a>. These issues can be linked to commits by adding text such as <code>fixes gh-5</code>).</p>
<p>Rationale: This workflow is a small upfront investment that reduces error and time spent re-creating and debugging errors. Associating issues and commits, makes it easier to identify why a change was made, and potential bugs that could arise when the code is changed. In addition, knowing which issue you are working on clarifies the scope and objectives of your current task.</p>

</div>
</div>
</div>
<div id="coding-practices" class="section level2">
<h2><span class="header-section-number">8.3</span> Coding Practices</h2>

<div id="developer-codestyle" class="section level3">
<h3><span class="header-section-number">8.3.1</span> Coding Style</h3>
<p>Consistent coding style improves readability and reduces errors in
shared code.</p>
<p>R does not have an official style guide, but Hadley Wickham provides one that is well
thought out and widely adopted. <a href="http://r-pkgs.had.co.nz/style.html">Advanced R: Coding Style</a>.</p>
<p>Both the Wickham text and this page are derived from <a href="https://google.github.io/styleguide/Rguide.xml">Google’s R Style Guide</a>.</p>
<div id="use-roxygen2-documentation" class="section level4">
<h4><span class="header-section-number">8.3.1.1</span> Use Roxygen2 documentation</h4>
<p>This is the standard method of documentation used in PEcAn development,
it provides inline documentation similar to doxygen. Even trivial
functions should be documented.</p>
<p>See <a href="developer-guide.html#developer-roxygen">Roxygen2</a>.</p>
</div>
<div id="write-your-name-at-the-top" class="section level4">
<h4><span class="header-section-number">8.3.1.2</span> Write your name at the top</h4>
<p>Any function that you create or make a meaningful contribution to should
have your name listed after the author tag in the function documentation.</p>
</div>
<div id="use-testthat-testing-package" class="section level4">
<h4><span class="header-section-number">8.3.1.3</span> Use testthat testing package</h4>
<p>See <a href="developer-guide.html#developer-testing">Unit_Testing</a> for instructions, and <a href="http://r-pkgs.had.co.nz/tests.html">Advanced R: Tests</a>.</p>
<ul>
<li>tests provide support for documentation - they define what a function is (and is not) expected to do</li>
<li>all functions need tests to ensure basic functionality is maintained during development.</li>
<li>all bugs should have a test that reproduces the bug, and the test should pass before bug is closed</li>
</ul>
</div>
<div id="dont-use-shortcuts" class="section level4">
<h4><span class="header-section-number">8.3.1.4</span> Don’t use shortcuts</h4>
<p>R provides many shortcuts that are useful when coding interactively, or for writing scripts. However, these can make code more difficult to read and can cause problems when written into packages.</p>
</div>
<div id="function-names-verb.noun" class="section level4">
<h4><span class="header-section-number">8.3.1.5</span> Function Names (<code>verb.noun</code>)</h4>
<p>Following convention established in PEcAn 0.1, we use the all lowercase with periods to separate words. They should generally have a <code>verb.noun</code> format, such as <code>query.traits</code>, <code>get.samples</code>, etc.</p>
</div>
<div id="file-names" class="section level4">
<h4><span class="header-section-number">8.3.1.6</span> File Names</h4>
<p>File names should end in <code>.R</code>, <code>.Rdata</code>, or <code>.rds</code> (as appropriate) and should be meaningful, e.g. named after the primary functions that they contain. There should be a separate file for each major high-level function to aid in identifying the contents of files in a directory.</p>
</div>
<div id="use---as-an-assignment-operator" class="section level4">
<h4><span class="header-section-number">8.3.1.7</span> Use “&lt;-” as an assignment operator</h4>
<p>Because most R code uses &lt;- (except where = is required), we will use &lt;-.
<code>=</code> is reserved for function arguments</p>
</div>
<div id="use-spaces" class="section level4">
<h4><span class="header-section-number">8.3.1.8</span> Use Spaces</h4>
<ul>
<li>around all binary operators (<code>=</code>, <code>+</code>, <code>-</code>, <code>&lt;-</code>, etc.).</li>
<li>after but not before a comma</li>
</ul>
</div>
<div id="use-curly-braces" class="section level4">
<h4><span class="header-section-number">8.3.1.9</span> Use curly braces</h4>
<p>The option to omit curly braces is another shortcut that makes code easier to write but harder to read and more prone to error.</p>
</div>
<div id="package-dependencies" class="section level4">
<h4><span class="header-section-number">8.3.1.10</span> Package Dependencies</h4>
<div id="executive-summary-what-to-usually-do" class="section level5">
<h5><span class="header-section-number">8.3.1.10.1</span> Executive Summary: What to usually do</h5>
<p>When you’re editing one PEcAn package and want to use a function from any other R package (including other PEcAn packages), the standard method is to add the other package to the <code>Imports:</code> field of your DESCRIPTION file, spell the function in fully namespaced form (<code>pkg::function()</code>) everywhere you call it, and be done. There are a few cases where this isn’t enough, but they’re rarer than you think. The rest of this section mostly deals with the exceptions to this rule and why not to use them when they can be avoided.</p>
</div>
<div id="big-picture-whats-possible-to-do" class="section level5">
<h5><span class="header-section-number">8.3.1.10.2</span> Big Picture: What’s possible to do</h5>
<p>To make one PEcAn package use functionality from another R package (including other PEcAn packages), you must do at least one and up to four things in your own package.</p>
<ul>
<li>Always, <em>declare</em> which packages your package depends on, so that R can install them as needed when someone installs your package and so that human readers can understand what additional functionality it uses. Declare dependencies by manually adding them to your package’s DESCRIPTION file.</li>
<li>Sometimes, <em>import</em> functions from the dependency package into your package’s namespace, so that your functions know where to find them. This is only sometimes necessary, because you can usually use <code>::</code> to call functions without importing them. Import functions by writing Roxygen <code>@importFrom</code> statements and do not edit the NAMESPACE file by hand.</li>
<li>Rarely, <em>load</em> dependency code into the R environment, so that the person using your package can use it without loading it separately. This is usually a bad idea, has caused many subtle bugs, and in PEcAn it should only be used when unavoidable. When unavoidable, prefer <code>requireNamespace(... quietly = TRUE)</code> over <code>Depends:</code> or <code>require()</code> or <code>library()</code>.</li>
<li>Only if your dependency relies on non-R tools, <em>install</em> any components that R won’t know how to find for itself. These components are often but not always identifiable from a <code>SystemRequirements</code> field in the dependency’s DESCRIPTION file. The exact installation procedure will vary case by case and from one operating system to another, and for PEcAn the key point is that you should skip this step until it proves necessary. When it does prove necessary, edit the documentation for your package to include advice on installing the dependency components, then edit the PEcAn build and testing scripts as needed so that they follow your advice.</li>
</ul>
<p>The advice below about each step is written specifically for PEcAn, although much of it holds for R packages in general. For more details about working with dependencies, start with Hadley Wickham’s <a href="http://r-pkgs.had.co.nz/description.html#dependencies">R packages</a> and treat the CRAN team’s <a href="https://cran.r-project.org/doc/manuals/R-exts.html">Writing R Extensions</a> as the final authority.</p>
</div>
<div id="declaring-dependencies-depends-suggests-imports" class="section level5">
<h5><span class="header-section-number">8.3.1.10.3</span> Declaring Dependencies: Depends, Suggests, Imports</h5>
<p>List all dependencies in the DESCRIPTION file. Every package that is used by your package’s code must appear in exactly one of the sections <code>Depends</code>, <code>Imports</code>, or <code>Suggests</code>.</p>
<p>Please list packages in alphabetical order within each section. R doesn’t care about the order, but you will later when you’re trying to check whether this package uses a particular dependency.</p>
<ul>
<li><p><code>Imports</code> is the correct place to declare most PEcAn dependencies. This ensures that they get installed, but <em>does not</em> automatically import any of their functions – Since PEcAn style prefers to mostly use <code>::</code> instead of importing, this is what we want.</p></li>
<li><p><code>Depends</code> is, despite the name, usually the wrong place to declare PEcAn dependencies. The only difference between <code>Depends</code> and <code>Imports</code> is that when the user attaches your packages to their own R workspace (e.g. using <code>library(&quot;PEcAn.yourpkg&quot;)</code>), the packages in <code>Depends</code> are attached as well. Notice that a call like <code>PEcAn.yourpkg::yourfun()</code> <em>will not</em> attach your package <em>or</em> its dependencies, so your code still needs to import or <code>::</code>-qualify all functions from packages listed in <code>Depends</code>. In short, <code>Depends</code> is not a shortcut, is for user convenience not developer convenience, and makes it easy to create subtle bugs that appear to work during interactive test sessions but fail when run from scripts. As the <a href="https://cran.r-project.org/doc/manuals/R-exts.html#Package-Dependencies">R extensions manual</a> puts it (emphasis added):</p>
<blockquote>
<p>This [Imports and Depends] scheme was developed before all packages had namespaces (R 2.14.0 in October 2011), and good practice changed once that was in place. Field ‘Depends’ should nowadays be used rarely, only for packages which are intended to be put on the search path to make their facilities <strong>available to the end user (and not to the package itself)</strong>.&quot;</p>
</blockquote></li>
<li><p>The <code>Suggests</code> field can be used to declare dependencies on packages that make your package more useful but are not completely essential. Again from the <a href="https://cran.r-project.org/doc/manuals/R-exts.html#Package-Dependencies">R extensions manual</a>:</p>
<blockquote>
<p>The <code>Suggests</code> field uses the same syntax as <code>Depends</code> and lists packages that are not necessarily needed. This includes packages used only in examples, tests or vignettes (see <a href="https://cran.r-project.org/doc/manuals/R-exts.html#Writing-package-vignettes">Writing package vignettes</a>), and packages loaded in the body of functions. E.g., suppose an example from package foo uses a dataset from package bar. Then it is not necessary to have bar use foo unless one wants to execute all the examples/tests/vignettes: it is useful to have bar, but not necessary.</p>
</blockquote>
<p>Some of the PEcAn model interface packages push this definition of “not necessarily needed” by declaring their coupled model package in <code>Suggests</code> rather than <code>Imports</code>. For example, the <code>PEcAn.BIOCRO</code> package cannot do anything useful when the BioCro model is not installed, but it lists BioCro in Suggests because <em>PEcAn as a whole</em> can work without it. This is a compromise to simplify installation of PEcAn for users who only plan to use a few models, so that they can avoid the bother of installing BioCro if they only plan to run, say, SIPNET.</p>
<p>Since the point of Suggests is that they are allowed to be missing, all code that uses a suggested package must behave reasonably when the package is not found. Depending on the situation, “reasonably” could mean checking whether the package is available and throwing an error as needed (PEcAn.BIOCRO uses its <code>.onLoad</code> function to check at load time whether BioCro is installed and will refuse to load if it is not), or providing an alternative behavior (<code>PEcAn.data.atmosphere::get_NARR_thredds</code> checks at call time for either <code>parallel</code> or <code>doParallel</code> and uses whichever one it finds first), or something else, but your code should never just assume that the suggested package is available.</p>
<p>You are not allowed to import functions from <code>Suggests</code> into your package’s namespace, so always call them in <code>::</code>-qualified form. By default R will not install suggested packages when your package is installed, but users can change this using the <code>dependencies</code> argument of <code>install.packages</code>. Note that for testing on Travis CI, PEcAn <em>does</em> install all <code>Suggests</code> (because they are required for full package checks), so any of your code that runs when a suggested package is not available will never be exercised by Travis checks.</p>
<p>It is often tempting to move a dependency from Imports to Suggests because it is a hassle to install (large, hard to compile, no longer available from CRAN, currently broken on GitHub, etc), in the hopes that this will isolate the rest of PEcAn from the troublesome dependency. This helps for some cases, but fails for two very common ones: It does not reduce install time for CI builds, because all suggested packages need to be present when running full package checks (<code>R CMD check</code> or <code>devtools::check</code> or <code>make check</code>). It also does not prevent breakage when updating PEcAn via <code>make install</code>, because <code>devtools::install_deps</code> does not install suggested packages that are missing but does try to <em>upgrade</em> any that are already installed to the newest available version – even if the installed version took ages to compile and would have worked just fine!</p></li>
</ul>
</div>
<div id="importing-functions-use-roxygen" class="section level5">
<h5><span class="header-section-number">8.3.1.10.4</span> Importing Functions: Use Roxygen</h5>
<p>PEcAn style is to import very few functions and instead use fully namespaced function calls (<code>pkg::fn()</code>) everywhere it’s practical to do so. In cases where double-colon notation would be especially burdensome, such as when importing custom binary operators like <code>%&gt;%</code>, it’s acceptable to import specific functions into the package namespace. Do this by using Roxygen comments of the form <code>#' @importFrom pkg function</code>, not by hand-editing the NAMESPACE file.</p>
<p>If the import is only used in one or a few functions, use an <code>@importFrom</code> in the documentation for each function that uses it. If it is used all over the package, use a single <code>@importFrom</code> in the Roxygen documentation block for the whole package, which probably lives in a file called either <code>zzz.R</code> or <code>&lt;your_package_name&gt;-package.R</code>:</p>
<pre><code>## NULL</code></pre>
<p>Roxygen will make sure there’s only one NAMESPACE entry per imported function no matter how many <code>importFrom</code> statements there are, but please pick a scheme (either import on every usage or once for the whole package), stick with it, and do not make function <code>x()</code> rely on an importFrom in the comments above function <code>y()</code>.</p>
<p>Please do <em>not</em> import entire package namespaces (<code>#' @import pkg</code>); it increases the chance of function name collisions and makes it much harder to understand which package a given function was called from.</p>
<p>A special note about importing functions from the <a href="https://tidyverse.org">tidyverse</a>: Be sure to import from the package(s) that actually contain the functions you want to use, e.g. <code>Imports: dplyr, magrittr, purrr</code> / <code>@importFrom magrittr %&gt;%</code> / <code>purrr::map(...)</code>, not <code>Imports: tidyverse</code> / <code>@importFrom tidyverse %&gt;%</code> / <code>tidyverse::map(...)</code>. The package named <code>tidyverse</code> is just a interactive shortcut that loads the whole collection of constituent packages; it doesn’t export any functions in its own namespace and therefore importing it into your package doesn’t make them available.</p>
</div>
<div id="loading-code-dont-but-use-requirenamespace-when-you-do" class="section level5">
<h5><span class="header-section-number">8.3.1.10.5</span> Loading Code: Don’t… But Use <code>requireNamespace</code> When You Do</h5>
<p>The very short version of this section: We want to maintain clear separation between the <a href="http://r-pkgs.had.co.nz/namespace.html">package’s namespace</a> (which we control and want to keep predictable) and the global namespace (which the user controls, might change in ways we have no control over, and will be justifiably angry if we change it in ways they were not expecting). Therefore, avoid attaching packages to the search path (so no <code>Depends</code> and no <code>library()</code> or <code>require()</code> inside functions), and do not explicitly load other namespaces if you can help it.</p>
<p>The longer version requires that we make a distinction often glossed over: <em>Loading</em> a package makes it possible for <em>R</em> to find things in the package namespace and does any actions needed to make it ready for use (e.g. running its .onLoad method, loading DLLs if the package contains compiled code, etc). <em>Attaching</em> a package (usually by calling <code>library(&quot;somePackage&quot;)</code>) loads it if it wasn’t already loaded, and then adds it to the search path so that the <em>user</em> can find things in its namespace. As discussed in the “Declaring Dependancies” section above, dependencies listed in <code>Depends</code> will be attached when your package is attached, but they will be <em>neither attached nor loaded</em> when your package is loaded without being attached.</p>
<p>Loading a dependency into the package namespace is undesirable because it makes it hard to understand our own code – if we need to use something from elsewhere, we’d prefer call it from its own namespace using <code>::</code> (which implicitly loads the dependency!) or explicitly import it with a Roxygen <code>@import</code> directive. But in a few cases this isn’t enough. The most common reason to need to explicitly load a dependency is that some packages <em>define</em> new S3 methods for generic functions defined in other packages, but do not <em>export</em> these methods directly. We would prefer that these packages did not do this, but sometimes we have to use them anyway. An <a href="https://github.com/PecanProject/pecan/issues/1368">example from PEcAn</a> is that PEcAn.MA needs to call <code>as.matrix</code> on objects of class <code>mcmc.list</code>. When the <code>coda</code> namespace is loaded, <code>as.matrix(some_mcmc.list)</code> can be correctly dispatched by <code>base::as.matrix</code> to the unexported method <code>coda:::as.matrix.mcmc.list</code>, but when <code>coda</code> is not loaded this dispatch will fail. Unfortunately coda does not export <code>as.matrix.mcmc.list</code> so we cannot call it directly or import it into the PEcAn.MA namespace, so instead we <a href="https://github.com/PecanProject/pecan/pull/1966/files#diff-e0b625a54a8654cc9b22d9c076e7a838R13">load the <code>coda</code> namespace</a> whenever PEcAn.MA is loaded.</p>
<p>Attaching packages to the user’s search path is even more problematic because it makes it hard for the user to understand <em>how your package will affect their own code</em>. Packages attached by a function stay attached after the function exits, so they can cause name collisions far downstream of the function call, potentially in code that has nothing to do with your package. And worse, since names are looked up in reverse order of package loading, it can cause behavior that differs in strange ways depending on the order of lines that look independent of each other:</p>
<p>This is not to say that users will <em>never</em> want your package to attach another one for them, just that it’s rare and that attaching dependencies is much more likely to cause bugs than to fix them and additionally doesn’t usually save the package author any work.</p>
<p>One possible exception to the do-not-attach-packages rule is a case where your dependency ignores all good practice and wrongly assumes, without checking, that all of its own dependencies are attached; if its DESCRIPTION uses only <code>Depends</code> instead of <code>Imports</code>, this is often a warning sign. For example, a small-but-surprising number of packages depend on the <code>methods</code> package without proper checks (this is probably because most <em>but not all</em> R interpreters attach <code>methods</code> by default and therefore it’s easy for an author to forget it might ever be otherwise unless they happen to test with a but-not-all interpreter).</p>
<p>If you find yourself with a dependency that does this, accept first that you are relying on a package that is broken, and you should either convince its maintainer to fix it or find a way to remove the dependency from PEcAn. But as a short-term workaround, it is sometimes possible for your code to attach the direct dependency so that it will behave right with regard to its secondary dependencies. If so, make sure the attachment happens every time your package is loaded (e.g. by calling <code>library(depname)</code> inside your package’s <code>.onLoad</code> method) and not just when your package is attached (e.g. by putting it in Depends).</p>
<p>When you do need to load or attach a dependency, it is probably better to do it inside your package’s <code>.onLoad</code> method rather than in individual functions, but this isn’t ironclad. To only load, use <code>requireNamespace(pkgname, quietly=TRUE)</code> – this will make it available inside your package’s namespace while avoiding (most) annoying loadtime messages and not disturbing the user’s search path. To attach when you really can’t avoid it, declare the dependency in <code>Depends</code> and <em>also</em> attach it using <code>library(pkgname)</code> in your .onLoad method.</p>
<p>Note that scripts in <code>inst/</code> are considered to be sample code rather than part of the package namespace, so it is acceptable for them to explicitly attach packages using <code>library()</code>. You may also see code that uses <code>require(pkgname)</code>; this is just like <code>library</code>, but returns FALSE instead of erroring if package load fails. It is OK for scripts in <code>inst/</code> that can do <em>and do</em> do something useful when a dependency is missing, but if it is used as <code>if(!require(pkg)){ stop(...)}</code> then replace it with <code>library(pkg)</code>.</p>
<p>If you think your package needs to load or attach code for any reason, please note why in your pull request description and be prepared for questions about it during code review. If your reviewers can think of an alternate approach that avoids loading or attaching, they will likely ask you to use it even if it creates extra work for you.</p>
</div>
<div id="installing-dependencies-let-the-machines-do-it" class="section level5">
<h5><span class="header-section-number">8.3.1.10.6</span> Installing dependencies: Let the machines do it</h5>
<p>In most cases you won’t need to think about how dependencies get installed – just declare them in your package’s DESCRIPTION and the installation will be handled automatically by R and devtools during the build process. In PEcAn packages, the rare cases where this isn’t enough will probably fall into one of two categories.</p>
<p>First, some dependencies rely on non-R software that R does not know how to install automatically. For example, rjags relies on JAGS, which might be installed in a different place on every machine. If your dependency falls in this category, you will know (because your CI builds will keep failing until you figure out how to fix it), but the exact details of the fix will differ for every case.</p>
<p>Second, some dependencies <em>will</em> install automatically, but they take a long time to compile or conflict with dependencies needed by other packages or are otherwise annoying to deal with. To save time during CI builds, PEcAn’s Travis configuration file includes a manually curated list of the most-annoying dependencies and installs them from pre-compiled binaries before starting the normal installation process. If you suspect you’re adding a dependency that will be “annoying”, please <em>do not</em> add it to the Travis binary-install list right away; instead, focus on getting your package to work right using the default automatic installation. Then, if needed to keep build times reasonable, submit a separate pull request to change the Travis configuration. This two-step procedure makes it much easier to understand which merges changed package code and which ones changed the testing configuration without changing package functionality, and also lets you focus on what the code is supposed to do instead of on installation details.</p>

</div>
</div>
</div>
<div id="developer-logging" class="section level3">
<h3><span class="header-section-number">8.3.2</span> Logging</h3>
<p>During development we often add many print statements to check to see how the code is doing, what is happening, what intermediate results there are etc. When done with the development it would be nice to turn this additional code off, but have the ability to quickly turn it back on if we discover a problem. This is where logging comes into play. Logging allows us to use “rules” to say what information should be shown. For example when I am working on the code to create graphs, I do not have to see any debugging information about the SQL command being sent, however trying to figure out what goes wrong during a SQL statement it would be nice to show the SQL statements without adding any additional code.</p>
<div id="pecan-logging-functions" class="section level4">
<h4><span class="header-section-number">8.3.2.1</span> PEcAn logging functions</h4>
<p>These <code>logger</code> family of functions are more sophisticated, and can be used in place of <code>stop</code>, <code>warn</code>, <code>print</code>, and similar functions. The <code>logger</code> functions make it easier to print to a system log file.</p>
<ul>
<li>The file <a href="../blob/master/utils/inst/tests/test.logger.R">test.logger.R</a> provides descriptive examples</li>
<li>This query provides an current overview of <a href="https://github.com/PecanProject/pecan/search?q=logger&amp;ref=cmdform">functions that use logging</a></li>
<li>logger functions (in order of increasing level):</li>
<li><code>logger.debug</code></li>
<li><code>logger.info</code></li>
<li><code>logger.warn</code></li>
<li><code>logger.error</code></li>
<li>the <code>logger.setLevel</code> function sets the level at which a message will be printed</li>
<li><code>logger.setLevel(&quot;DEBUG&quot;)</code> will print messages from all logger functions</li>
<li><code>logger.setLevel(&quot;ERROR&quot;)</code> will only print messages from <code>logger.error</code></li>
<li><code>logger.setLevel(&quot;INFO&quot;)</code> and <code>logger.setLevel(&quot;WARN&quot;)</code> shows messages from <code>logger.&lt;level&gt;</code> and higher functions, e.g. <code>logger.setLevel(&quot;WARN&quot;)</code> shows messages from <code>logger.warn</code> and <code>logger.error</code></li>
<li><code>logger.setLevel(&quot;OFF&quot;)</code> suppresses all logger messages</li>
<li>To print all messages to console, use <code>logger.setUseConsole(TRUE)</code></li>
</ul>
</div>
<div id="other-r-logging-packages" class="section level4">
<h4><span class="header-section-number">8.3.2.2</span> Other R logging packages</h4>
<ul>
<li><strong>This section is for reference - these functions should not be used in PEcAn, as they are redundant with the <code>logger.*</code> functions described above</strong></li>
</ul>
<p>R does provide a basic logging capability using stop, warning and message. These allow to print message (and stop execution in case of stop). However there is not an easy method to redirect the logging information to a file, or turn the logging information on and off. This is where one of the following packages comes into play. The packages themselves are very similar since they try to emulate log4j.</p>
<p>Both of the following packages use a hierarchic loggers, meaning that if you change the level of displayed level of logging at one level all levels below it will update their logging.</p>
<div id="logging" class="section level5">
<h5><span class="header-section-number">8.3.2.2.1</span> <code>logging</code></h5>
<p>The logging development is done at <a href="http://logging.r-forge.r-project.org/" class="uri">http://logging.r-forge.r-project.org/</a> and more information is located at <a href="http://cran.r-project.org/web/packages/logging/index.html" class="uri">http://cran.r-project.org/web/packages/logging/index.html</a> . To install use the following command:</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb78-1" data-line-number="1"><span class="kw">install.packages</span>(<span class="st">&quot;logging&quot;</span>, <span class="dt">repos=</span><span class="st">&quot;http://R-Forge.R-project.org&quot;</span>)</a></code></pre></div>
<p>This has my preference pure based on documentation.</p>
</div>
</div>
<div id="futile.logger" class="section level4">
<h4><span class="header-section-number">8.3.2.3</span> <code>futile.logger</code></h4>
<p>The second logging package is <a href="http://cran.r-project.org/web/packages/futile.logger/" class="uri">http://cran.r-project.org/web/packages/futile.logger/</a> and is eerily similar to logging (as a matter of fact logging is based on futile).</p>
<div id="example-usage" class="section level5">
<h5><span class="header-section-number">8.3.2.3.1</span> Example Usage</h5>
<p>To be able to use the loggers there needs to be some initialization done. Neither package allows to read it from a configuration file, so we might want to use the pecan.xml file to set it up. The setup will always be somewhat the same:</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb79-1" data-line-number="1"><span class="co"># load library</span></a>
<a class="sourceLine" id="cb79-2" data-line-number="2"><span class="kw">library</span>(logging)</a>
<a class="sourceLine" id="cb79-3" data-line-number="3"><span class="kw">logReset</span>()</a>
<a class="sourceLine" id="cb79-4" data-line-number="4"></a>
<a class="sourceLine" id="cb79-5" data-line-number="5"><span class="co"># add handlers, responsible for actually printing/saving the messages</span></a>
<a class="sourceLine" id="cb79-6" data-line-number="6"><span class="kw">addHandler</span>(writeToConsole)</a>
<a class="sourceLine" id="cb79-7" data-line-number="7"><span class="kw">addHandler</span>(writeToFile, <span class="dt">file=</span><span class="st">&quot;file.log&quot;</span>)</a>
<a class="sourceLine" id="cb79-8" data-line-number="8"></a>
<a class="sourceLine" id="cb79-9" data-line-number="9"><span class="co"># setup root logger with INFO</span></a>
<a class="sourceLine" id="cb79-10" data-line-number="10"><span class="kw">setLevel</span>(<span class="st">&#39;INFO&#39;</span>)</a>
<a class="sourceLine" id="cb79-11" data-line-number="11"></a>
<a class="sourceLine" id="cb79-12" data-line-number="12"><span class="co"># make all of PEcAn print debug messages</span></a>
<a class="sourceLine" id="cb79-13" data-line-number="13"><span class="kw">setLevel</span>(<span class="st">&#39;DEBUG&#39;</span>, <span class="kw">getLogger</span>(<span class="st">&#39;PEcAn&#39;</span>))</a>
<a class="sourceLine" id="cb79-14" data-line-number="14"></a>
<a class="sourceLine" id="cb79-15" data-line-number="15"><span class="co"># only print info and above for the SQL part of PEcAn</span></a>
<a class="sourceLine" id="cb79-16" data-line-number="16"><span class="kw">setLevel</span>(<span class="st">&#39;INFO&#39;</span>, <span class="kw">getLogger</span>(<span class="st">&#39;PEcAn.SQL&#39;</span>))</a></code></pre></div>
<p>To now use logging in the code you can use the following code:</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb80-1" data-line-number="1">pl &lt;-<span class="st"> </span><span class="kw">getLogger</span>(<span class="st">&#39;PEcAn.MetaAnalysis.function1&#39;</span>)</a>
<a class="sourceLine" id="cb80-2" data-line-number="2">pl<span class="op">$</span><span class="kw">info</span>(<span class="st">&quot;This is an INFO message.&quot;</span>)</a>
<a class="sourceLine" id="cb80-3" data-line-number="3">pl<span class="op">$</span><span class="kw">debug</span>(<span class="st">&quot;The value for x=%d&quot;</span>, x)</a>
<a class="sourceLine" id="cb80-4" data-line-number="4">pl<span class="op">$</span><span class="kw">error</span>(<span class="st">&quot;Something bad happened and I am scared now.&quot;</span>)</a></code></pre></div>
<p>or</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb81-1" data-line-number="1"><span class="kw">loginfo</span>(<span class="st">&quot;This is an INFO message.&quot;</span>, <span class="dt">logger=</span><span class="st">&quot;PEcAn.MetaAnalysis.function1&quot;</span>)</a>
<a class="sourceLine" id="cb81-2" data-line-number="2"><span class="kw">logdebug</span>(<span class="st">&quot;The value for x=%d&quot;</span>, x, <span class="dt">logger=</span><span class="st">&quot;PEcAn.MetaAnalysis.function1&quot;</span>)</a>
<a class="sourceLine" id="cb81-3" data-line-number="3"><span class="kw">logerror</span>(<span class="st">&quot;Something bad happened and I am scared now.&quot;</span>, <span class="dt">logger=</span><span class="st">&quot;PEcAn.MetaAnalysis.function1&quot;</span>)</a></code></pre></div>

</div>
</div>
</div>
<div id="developer-packagedata" class="section level3">
<h3><span class="header-section-number">8.3.3</span> Package Data</h3>
<div id="summary" class="section level4">
<h4><span class="header-section-number">8.3.3.1</span> Summary:</h4>
<p>Files with the following extensions will be read by R as data:</p>
<ul>
<li>plain R code in .R and .r files are sourced using <code>source()</code></li>
<li>text tables in .tab, .txt, .csv files are read using <code>read()</code>
** objects in R image files: .RData, .rda are loaded using <code>load()</code></li>
<li>capitalization matters</li>
<li>all objects in foo.RData are loaded into environment</li>
<li>pro: easiset way to store objects in R format</li>
<li>con: format is application (R) specific</li>
</ul>
<p>Details are in <code>?data</code>, which is mostly a copy of <a href="http://cran.r-project.org/doc/manuals/R-exts.html#Data-in-packages">Data section of
Writing R
Extensions</a>.</p>
</div>
<div id="accessing-data" class="section level4">
<h4><span class="header-section-number">8.3.3.2</span> Accessing data</h4>
<p>Data in the [data] directory will be accessed in the following ways,</p>
<ul>
<li>efficient way: (especially for large data sets) using the <code>data</code>
function:</li>
</ul>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb82-1" data-line-number="1"><span class="kw">data</span>(foo) <span class="co"># accesses data with, e.g. load(foo.RData), read(foo.csv), or source(foo.R) </span></a></code></pre></div>
<ul>
<li>easy way: by adding the following line to the package DESCRIPTION:
<em>note:</em> this should be used with caution or it can cause difficulty as discussed in redmine issue #1118</li>
</ul>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb83-1" data-line-number="1">LazyData<span class="op">:</span><span class="st"> </span><span class="ot">TRUE</span></a></code></pre></div>
<p>From the R help page:</p>
<p>Currently, a limited number of data formats can be accessed using the <code>data</code> function by placing one of the following filetypes in a packages’ <code>data</code> directory:
* files ending <code>.R</code> or <code>.r</code> are <code>source()</code>d in, with the R working
directory changed temporarily to the directory containing the respective
file. (<code>data</code> ensures that the <code>utils</code> package is attached, in case it
had been run <em>via</em> <code>utils::data</code>.)
* files ending <code>.RData</code> or <code>.rda</code> are <code>load()</code>ed.
* files ending <code>.tab</code>, <code>.txt</code> or <code>.TXT</code> are read using <code>read.table(..., header = TRUE)</code>, and hence result in a data frame.
* files ending <code>.csv</code> or <code>.CSV</code> are read using <code>read.table(..., header = TRUE, sep = ';')</code>, and also result in a data frame.</p>
<p>If your data does not fall in those 4 categories, or you can use the
<code>system.file</code> function to get access to the data:</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb84-1" data-line-number="1"><span class="kw">system.file</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;ed.trait.dictionary.csv&quot;</span>, <span class="dt">package=</span><span class="st">&quot;PEcAn.utils&quot;</span>)</a>
<a class="sourceLine" id="cb84-2" data-line-number="2">[<span class="dv">1</span>] <span class="st">&quot;/home/kooper/R/x86_64-pc-linux-gnu-library/2.15/PEcAn.utils/data/ed.trait.dictionary.csv&quot;</span></a></code></pre></div>
<p>The arguments are folder, filename(s) and then package. It will return
the fully qualified path name to a file in a package, in this case it
points to the trait data. This is almost the same as the data function,
however we can now use any function to read the file, such as read.csv
instead of read.csv2 which seems to be the default of data. This also
allows us to store arbitrary files in the data folder, such as the the
bug file and load it when we need it.</p>
<div id="examples-of-data-in-pecan-packages" class="section level5">
<h5><span class="header-section-number">8.3.3.2.1</span> Examples of data in PEcAn packages</h5>
<ul>
<li>outputs: [/modules/uncertainties/data/output.RData]</li>
<li>parameter samples [/modules/uncertainties/data/samples.RData]</li>
</ul>

</div>
</div>
</div>
<div id="developer-roxygen" class="section level3">
<h3><span class="header-section-number">8.3.4</span> Roxygen2</h3>
<p>This is the standard method of documentation used in PEcAn development, it provides inline documentation similar to doxygen.</p>
<div id="canonical-references" class="section level4">
<h4><span class="header-section-number">8.3.4.1</span> Canonical references:</h4>
<ul>
<li>Must Read: R package development by Hadley Wickham:</li>
<li><a href="http://r-pkgs.had.co.nz/man.html"><strong>Object Documentation</strong></a><br />
</li>
<li><a href="http://r-pkgs.had.co.nz/description.html">Package Metadata</a></li>
<li>Roxygen2 Documentation</li>
<li><a href="http://cran.r-project.org/web/packages/roxygen2/roxygen2.pdf">Roxygen2 Package Documentation</a></li>
<li><a href="https://github.com/klutometis/roxygen">GitHub</a></li>
</ul>
</div>
<div id="basic-roxygen2-instructions" class="section level4">
<h4><span class="header-section-number">8.3.4.2</span> Basic Roxygen2 instructions:</h4>
<p>Section headers link to “Writing R extensions” which provides in-depth documentation. This is provided as an overview and quick reference.</p>
</div>
<div id="tags-1" class="section level4">
<h4><span class="header-section-number">8.3.4.3</span> <a href="http://cran.r-project.org/doc/manuals/R-exts.html#Documenting-functions">Tags</a></h4>
<ul>
<li>tags are preceeded by <code>##'</code></li>
<li>tags required by R:
** <code>title</code> tag is required, along with actual title
** <code>param</code> one for each parameter, should be defined
** <code>return</code> must state what function returns (or nothing, if something occurs as a side effect</li>
<li>tags strongly suggested for most functions:
** <code>author</code>
** <code>examples</code> can be similar to test cases.</li>
<li>optional tags:
** <code>export</code> required if function is used by another package
** <code>import</code> can import a required function from another package (if package is not loaded or other function is not exported)
** <code>seealso</code> suggests related functions. These can be linked using <code>\code{link{}}</code></li>
</ul>
</div>
<div id="text-markup" class="section level4">
<h4><span class="header-section-number">8.3.4.4</span> Text markup</h4>
<div id="formatting" class="section level5">
<h5><span class="header-section-number">8.3.4.4.1</span> <a href="http://cran.r-project.org/doc/manuals/R-exts.html#Marking-text">Formatting</a></h5>
<ul>
<li><code>\bold{}</code></li>
<li><code>\emph{}</code> italics</li>
</ul>
</div>
<div id="links" class="section level5">
<h5><span class="header-section-number">8.3.4.4.2</span> <a href="http://cran.r-project.org/doc/manuals/R-exts.html#Marking-text">Links</a></h5>
<ul>
<li><code>\url{www.url.com}</code> or <code>\href{url}{text}</code> for links</li>
<li><code>\code{\link{thisfn}}</code> links to function “thisfn” in the same package</li>
<li><code>\code{\link{foo::thatfn}}</code> links to function “thatfn” in package “foo”</li>
<li><code>\pkg{package_name}</code></li>
</ul>
</div>
<div id="math" class="section level5">
<h5><span class="header-section-number">8.3.4.4.3</span> <a href="http://cran.r-project.org/doc/manuals/R-exts.html#Mathematics">Math</a></h5>
<ul>
<li><code>\eqn{a+b=c}</code> uses LaTex to format an inline equation</li>
<li><code>\deqn{a+b=c}</code> uses LaTex to format displayed equation</li>
<li><code>\deqn{latex}{ascii}</code> and <code>\eqn{latex}{ascii}</code> can be used to provide different versions in latex and ascii.</li>
</ul>
</div>
<div id="lists" class="section level5">
<h5><span class="header-section-number">8.3.4.4.4</span> <a href="http://cran.r-project.org/doc/manuals/R-exts.html#Lists-and-tables">Lists</a></h5>
<pre><code>\enumerate{
\item A database consists of one or more records, each with one or
more named fields.
\item Regular lines start with a non-whitespace character.
\item Records are separated by one or more empty lines.
}
\itemize and \enumerate commands may be nested.</code></pre>
</div>
<div id="tableshttpcran.r-project.orgdocmanualsr-exts.htmllists-and-tables" class="section level5">
<h5><span class="header-section-number">8.3.4.4.5</span> “Tables”:<a href="http://cran.r-project.org/doc/manuals/R-exts.html#Lists-and-tables" class="uri">http://cran.r-project.org/doc/manuals/R-exts.html#Lists-and-tables</a></h5>
<pre><code>\tabular{rlll}{
[,1] \tab Ozone \tab numeric \tab Ozone (ppb)\cr
[,2] \tab Solar.R \tab numeric \tab Solar R (lang)\cr
[,3] \tab Wind \tab numeric \tab Wind (mph)\cr
[,4] \tab Temp \tab numeric \tab Temperature (degrees F)\cr
[,5] \tab Month \tab numeric \tab Month (1--12)\cr
[,6] \tab Day \tab numeric \tab Day of month (1--31)
}</code></pre>
</div>
</div>
<div id="example" class="section level4">
<h4><span class="header-section-number">8.3.4.5</span> Example</h4>
<p>Here is an example documented function, myfun</p>
<pre><code>##&#39; My function adds three numbers
##&#39;
##&#39; A great function for demonstrating Roxygen documentation
##&#39; @param a numeric
##&#39; @param b numeric
##&#39; @param c numeric
##&#39; @return d, numeric sum of a + b + c
##&#39; @export
##&#39; @author David LeBauer
##&#39; @examples
##&#39; myfun(1,2,3)
##&#39; \dontrun{myfun(NULL)}
myfun &lt;- function(a, b, c){
  d &lt;- a + b + c
  return(d)
}</code></pre>
<p>In emacs, with the cursor inside the function, the keybinding C-x O will generate an outline or update the Roxygen2 documentation.</p>
</div>
<div id="updating-documentation" class="section level4">
<h4><span class="header-section-number">8.3.4.6</span> Updating documentation</h4>
<ul>
<li>After adding documentation run the following command (replacing common with the name of the folder you want to update):
** In R using devtools to call roxygenize:</li>
</ul>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb88-1" data-line-number="1"><span class="kw">require</span>(devtools)</a>
<a class="sourceLine" id="cb88-2" data-line-number="2"><span class="kw">document</span>(<span class="st">&quot;common&quot;</span>)</a></code></pre></div>

</div>
</div>
<div id="developer-testing" class="section level3">
<h3><span class="header-section-number">8.3.5</span> Testing</h3>
<p>PEcAn uses the testthat package developed by Hadley Wickham. Hadley has
written instructions for using this package in his
<a href="http://adv-r.had.co.nz/Testing.html">Testing</a> chapter.</p>
<div id="rationale" class="section level4">
<h4><span class="header-section-number">8.3.5.1</span> Rationale</h4>
<ul>
<li>makes development easier</li>
<li>provides working documentation of expected functionality</li>
<li>saves time by allowing computer to take over error checking once a
test has been made</li>
<li>improves code quality</li>
<li>Further reading: <a href="http://arxiv.org/pdf/1210.0530v3.pdf">Aruliah et al 2012 Best Practices for Scientific Computing</a></li>
</ul>
</div>
<div id="tests-makes-development-easier-and-less-error-prone" class="section level4">
<h4><span class="header-section-number">8.3.5.2</span> Tests makes development easier and less error prone</h4>
<p>Testing makes it easier to develop by organizing everything you are
already doing anyway - but integrating it into the testing and
documentation. With a codebase like PEcAn, it is often difficult to get
started. You have to figure out</p>
<ul>
<li>what was I doing yesterday?</li>
<li>what do I want to do today?</li>
<li>what existing functions do I need to edit?</li>
<li>what are the arguments to these functions (and what are examples of
valid arguments)</li>
<li>what packages are affected</li>
<li>where is a logical place to put files used in testing</li>
</ul>
</div>
<div id="quick-start" class="section level4">
<h4><span class="header-section-number">8.3.5.3</span> Quick Start:</h4>
<ul>
<li>decide what you want to do today</li>
<li>identify the issue in github (if none exists, create one)</li>
<li><p>to work on issue 99, create a new branch called “github99” or some descriptive name… Today we will enable an
existing function, <code>make.cheas</code> to make <code>goat.cheddar</code>. We will know
that we are done by the color and taste.</p>
<pre><code>git branch goat-cheddar
git checkout goat-cheddar</code></pre></li>
<li>open existing (or create new) file in <code>inst/tests/</code>. If working on code in “myfunction” or a set of functions in “R/myfile.R”, the file should be named accordingly, e.g. “inst/tests/test.myfile.R”</li>
<li>if you are lucky, the function has already been tested and has some examples.</li>
<li><p>if not, you may need to create a minimal example, often requiring a settings file. The default settings file can be obtained in this way:</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb90-1" data-line-number="1">settings &lt;-<span class="st"> </span><span class="kw">read.settings</span>(<span class="kw">system.file</span>(<span class="st">&quot;extdata/test.settings.xml&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;PEcAn.utils&quot;</span>))</a></code></pre></div></li>
<li><p>write what you want to do</p>
<pre><code>test_that(&quot;make.cheas can make cheese&quot;,{
  goat.cheddar &lt;- make.cheas(source = &#39;goat&#39;, style = &#39;cheddar&#39;)
  expect_equal(color(goat.cheddar), &quot;orange&quot;)
  expect_is(object = goat.cheddar, class = &quot;cheese&quot;)
  expect_true(all(c(&quot;sharp&quot;, &quot;creamy&quot;) %in% taste(goat.cheddar)))
}</code></pre></li>
<li>now edit the goat.cheddar function until it makes savory, creamy, orange cheese.</li>
<li>commit often</li>
<li><p>update documentation and test</p></li>
<li>commit again</li>
<li><p>when complete, merge, and push</p></li>
</ul>
</div>
<div id="test-files" class="section level4">
<h4><span class="header-section-number">8.3.5.4</span> Test files</h4>
<p>Many of PEcAn’s functions require inputs that are provided as data.
These can be in the <code>/data</code> or the <code>/inst/extdata</code> folders of a package.
Data that are not package specific should be placed in the PEcAn.all or
PEcAn.utils files.</p>
<p>Some useful conventions:</p>
</div>
<div id="settings-1" class="section level4">
<h4><span class="header-section-number">8.3.5.5</span> Settings</h4>
<ul>
<li>A generic settings can be found in the PEcAn.all package</li>
</ul>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb92-1" data-line-number="1">settings.xml &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;pecan.biocro.xml&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;PEcAn.BIOCRO&quot;</span>)</a>
<a class="sourceLine" id="cb92-2" data-line-number="2">settings &lt;-<span class="st"> </span><span class="kw">read.settings</span>(settings.xml)</a></code></pre></div>
<ul>
<li>database settings can be specified, and tests run only if a connection is available</li>
</ul>
<p>We currently use the following database to run tests against; tests that require access to a database should check <code>db.exists()</code> and be skipped if it returns FALSE to avoid failed tests on systems that do not have the database installed.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb93-1" data-line-number="1">settings<span class="op">$</span>database &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">userid =</span> <span class="st">&quot;bety&quot;</span>, </a>
<a class="sourceLine" id="cb93-2" data-line-number="2">                          <span class="dt">passwd =</span> <span class="st">&quot;bety&quot;</span>, </a>
<a class="sourceLine" id="cb93-3" data-line-number="3">                          <span class="dt">name =</span> <span class="st">&quot;bety&quot;</span>,     <span class="co"># database name </span></a>
<a class="sourceLine" id="cb93-4" data-line-number="4">                          <span class="dt">host =</span> <span class="st">&quot;localhost&quot;</span> <span class="co"># server name)</span></a>
<a class="sourceLine" id="cb93-5" data-line-number="5"><span class="kw">test_that</span>(..., {</a>
<a class="sourceLine" id="cb93-6" data-line-number="6">  <span class="kw">skip_if_not</span>(<span class="kw">db.exists</span>(settings<span class="op">$</span>database))</a>
<a class="sourceLine" id="cb93-7" data-line-number="7">  ## write tests here</a>
<a class="sourceLine" id="cb93-8" data-line-number="8">})</a></code></pre></div>
<ul>
<li>instructions for installing this are available on the <a href="VM-Creation.md">VM creation
wiki</a></li>
<li><p>examples can be found in the PEcAn.DB package (<code>base/db/tests/testthat/</code>).</p></li>
<li><p>Model specific settings can go in the model-specific module, for
example:</p></li>
</ul>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb94-1" data-line-number="1">settings.xml &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;extdata/pecan.biocro.xml&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;PEcAn.BIOCRO&quot;</span>)</a>
<a class="sourceLine" id="cb94-2" data-line-number="2">settings &lt;-<span class="st"> </span><span class="kw">read.settings</span>(settings.xml)</a></code></pre></div>
<ul>
<li>test-specific settings:
<ul>
<li><p>settings text can be specified inline:</p>
<pre><code>settings.text &lt;- &quot;
  &lt;pecan&gt;
    &lt;nocheck&gt;nope&lt;/nocheck&gt; ## allows bypass of checks in the read.settings functions
    &lt;pfts&gt;
      &lt;pft&gt;
        &lt;name&gt;ebifarm.pavi&lt;/name&gt;
        &lt;outdir&gt;test/&lt;/outdir&gt;
      &lt;/pft&gt;
    &lt;/pfts&gt;
    &lt;outdir&gt;test/&lt;/outdir&gt;
    &lt;database&gt;
      &lt;userid&gt;bety&lt;/userid&gt;
      &lt;passwd&gt;bety&lt;/passwd&gt;
      &lt;location&gt;localhost&lt;/location&gt;
      &lt;name&gt;bety&lt;/name&gt;
    &lt;/database&gt;
  &lt;/pecan&gt;&quot;
settings &lt;- read.settings(settings.text)</code></pre></li>
<li><p>values in settings can be updated:</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb96-1" data-line-number="1">settings &lt;-<span class="st"> </span><span class="kw">read.settings</span>(settings.text)</a>
<a class="sourceLine" id="cb96-2" data-line-number="2">settings<span class="op">$</span>outdir &lt;-<span class="st"> &quot;/tmp&quot;</span> ## or any other settings</a></code></pre></div></li>
</ul></li>
</ul>
</div>
<div id="helper-functions-created-to-make-testing-easier" class="section level4">
<h4><span class="header-section-number">8.3.5.6</span> Helper functions created to make testing easier</h4>
<ul>
<li><strong>tryl</strong> returns FALSE if function gives error</li>
<li><strong>temp.settings</strong> creates temporary settings file</li>
<li><strong>test.remote</strong> returns TRUE if remote connection is available</li>
<li><strong>db.exists</strong> returns TRUE if connection to database is available</li>
</ul>
</div>
<div id="when-should-i-test" class="section level4">
<h4><span class="header-section-number">8.3.5.7</span> When should I test?</h4>
<p>A test <em>should</em> be written for each of the following situations:</p>
<ol style="list-style-type: decimal">
<li>Each bug should get a regression test.</li>
</ol>
<ul>
<li>The first step in handling a bug is to write code that reproduces the error</li>
<li>This code becomes the test</li>
<li>most important when error could re-appear</li>
<li>essential when error silently produces invalid results</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>Every time a (non-trivial) function is created or edited</li>
</ol>
<ul>
<li>Write tests that indicate how the function should perform
<ul>
<li>example: <code>expect_equal(sum(1,1), 2)</code> indicates that the sum
function should take the sum of its arguments</li>
</ul></li>
<li>Write tests for cases under which the function should throw an
error</li>
<li>example: <code>expect_error(sum(&quot;foo&quot;))</code></li>
<li>better : <code>expect_error(sum(&quot;foo&quot;), &quot;invalid 'type' (character)&quot;)</code></li>
</ul>
</div>
<div id="what-types-of-testing-are-important-to-understand" class="section level4">
<h4><span class="header-section-number">8.3.5.8</span> What types of testing are important to understand?</h4>
</div>
<div id="unit-testing-test-driven-development" class="section level4">
<h4><span class="header-section-number">8.3.5.9</span> Unit Testing / Test Driven Development</h4>
<p>Tests are only as good as the test</p>
<ol style="list-style-type: decimal">
<li>write test</li>
<li>write code</li>
</ol>
</div>
<div id="regression-testing" class="section level4">
<h4><span class="header-section-number">8.3.5.10</span> Regression Testing</h4>
<p>When a bug is found,</p>
<ol style="list-style-type: decimal">
<li>write a test that finds the bug (the minimum test required to make
the test fail)</li>
<li>fix the bug</li>
<li>bug is fixed when test passes</li>
</ol>
</div>
<div id="how-should-i-test-in-r-the-testthat-package." class="section level4">
<h4><span class="header-section-number">8.3.5.11</span> How should I test in R? The testthat package.</h4>
<p>tests are found in <code>~/pecan/&lt;packagename&gt;/inst/tests</code>, for example
<code>utils/inst/tests/</code></p>
<p>See attached file and
<a href="http://r-pkgs.had.co.nz/tests.html" class="uri">http://r-pkgs.had.co.nz/tests.html</a>
for details on how to use the testthat package.</p>
<div id="list-of-expectations" class="section level5">
<h5><span class="header-section-number">8.3.5.11.1</span> List of Expectations</h5>
<table>
<thead>
<tr class="header">
<th>Full</th>
<th>Abbreviation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>expect_that(x, is_true())</td>
<td>expect_true(x)</td>
</tr>
<tr class="even">
<td>expect_that(x, is_false())</td>
<td>expect_false(x)</td>
</tr>
<tr class="odd">
<td>expect_that(x, is_a(y))</td>
<td>expect_is(x, y)</td>
</tr>
<tr class="even">
<td>expect_that(x, equals(y))</td>
<td>expect_equal(x, y)</td>
</tr>
<tr class="odd">
<td>expect_that(x, is_equivalent_to(y))</td>
<td>expect_equivalent(x, y)</td>
</tr>
<tr class="even">
<td>expect_that(x, is_identical_to(y))</td>
<td>expect_identical(x, y)</td>
</tr>
<tr class="odd">
<td>expect_that(x, matches(y))</td>
<td>expect_matches(x, y)</td>
</tr>
<tr class="even">
<td>expect_that(x, prints_text(y))</td>
<td>expect_output(x, y)</td>
</tr>
<tr class="odd">
<td>expect_that(x, shows_message(y))</td>
<td>expect_message(x, y)</td>
</tr>
<tr class="even">
<td>expect_that(x, gives_warning(y))</td>
<td>expect_warning(x, y)</td>
</tr>
<tr class="odd">
<td>expect_that(x, throws_error(y))</td>
<td>expect_error(x, y)</td>
</tr>
</tbody>
</table>
</div>
<div id="how-to-run-tests" class="section level5">
<h5><span class="header-section-number">8.3.5.11.2</span> How to run tests</h5>
<p>add the following to “pecan/tests/testthat.R”</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb97-1" data-line-number="1"><span class="kw">library</span>(testthat)</a>
<a class="sourceLine" id="cb97-2" data-line-number="2"><span class="kw">library</span>(mypackage)</a>
<a class="sourceLine" id="cb97-3" data-line-number="3"></a>
<a class="sourceLine" id="cb97-4" data-line-number="4"><span class="kw">test_check</span>(<span class="st">&quot;mypackage&quot;</span>)</a></code></pre></div>
</div>
</div>
<div id="basic-use-of-the-testthat-package" class="section level4">
<h4><span class="header-section-number">8.3.5.12</span> basic use of the testthat package</h4>
<p>Here is an example of tests (these should be placed in
<code>&lt;packagename&gt;/tests/testthat/test-&lt;sourcefilename&gt;.R</code>:</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb98-1" data-line-number="1"><span class="kw">test_that</span>(<span class="st">&quot;mathematical operators plus and minus work as expected&quot;</span>,{</a>
<a class="sourceLine" id="cb98-2" data-line-number="2">  <span class="kw">expect_equal</span>(<span class="kw">sum</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb98-3" data-line-number="3">  <span class="kw">expect_equal</span>(<span class="kw">sum</span>(<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>), <span class="dv">-2</span>)</a>
<a class="sourceLine" id="cb98-4" data-line-number="4">  <span class="kw">expect_equal</span>(<span class="kw">sum</span>(<span class="dv">1</span>,<span class="ot">NA</span>), <span class="ot">NA</span>)</a>
<a class="sourceLine" id="cb98-5" data-line-number="5">  <span class="kw">expect_error</span>(<span class="kw">sum</span>(<span class="st">&quot;cat&quot;</span>))</a>
<a class="sourceLine" id="cb98-6" data-line-number="6">  <span class="kw">set.seed</span>(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb98-7" data-line-number="7">  <span class="kw">expect_equal</span>(<span class="kw">sum</span>(<span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>)), <span class="kw">sum</span>(<span class="kw">data.frame</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>)))</a>
<a class="sourceLine" id="cb98-8" data-line-number="8">})</a>
<a class="sourceLine" id="cb98-9" data-line-number="9"></a>
<a class="sourceLine" id="cb98-10" data-line-number="10"><span class="kw">test_that</span>(<span class="st">&quot;different testing functions work, giving excuse to demonstrate&quot;</span>,{</a>
<a class="sourceLine" id="cb98-11" data-line-number="11">  <span class="kw">expect_identical</span>(<span class="dv">1</span>, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb98-12" data-line-number="12">  <span class="kw">expect_identical</span>(<span class="kw">numeric</span>(<span class="dv">1</span>), <span class="kw">integer</span>(<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb98-13" data-line-number="13">  <span class="kw">expect_equivalent</span>(<span class="kw">numeric</span>(<span class="dv">1</span>), <span class="kw">integer</span>(<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb98-14" data-line-number="14">  <span class="kw">expect_warning</span>(<span class="kw">mean</span>(<span class="st">&#39;1&#39;</span>))</a>
<a class="sourceLine" id="cb98-15" data-line-number="15">  <span class="kw">expect_that</span>(<span class="kw">mean</span>(<span class="st">&#39;1&#39;</span>), <span class="kw">gives_warning</span>(<span class="st">&quot;argument is not numeric or logical: returning NA&quot;</span>))</a>
<a class="sourceLine" id="cb98-16" data-line-number="16">  <span class="kw">expect_warning</span>(<span class="kw">mean</span>(<span class="st">&#39;1&#39;</span>), <span class="st">&quot;argument is not numeric or logical: returning NA&quot;</span>)</a>
<a class="sourceLine" id="cb98-17" data-line-number="17">  <span class="kw">expect_message</span>(<span class="kw">message</span>(<span class="st">&quot;a&quot;</span>), <span class="st">&quot;a&quot;</span>)</a>
<a class="sourceLine" id="cb98-18" data-line-number="18">})</a></code></pre></div>
<div id="script-testing" class="section level5">
<h5><span class="header-section-number">8.3.5.12.1</span> Script testing</h5>
<p>It is useful to add tests to a script during development. This allows
you to test that the code is doing what you expect it to do.</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb99-1" data-line-number="1"><span class="op">*</span><span class="st"> </span>here is a fake script using the iris data set</a>
<a class="sourceLine" id="cb99-2" data-line-number="2"></a>
<a class="sourceLine" id="cb99-3" data-line-number="3"><span class="kw">test_that</span>(<span class="st">&quot;the iris data set has the same basic features as before&quot;</span>,{</a>
<a class="sourceLine" id="cb99-4" data-line-number="4">  <span class="kw">expect_equal</span>(<span class="kw">dim</span>(iris), <span class="kw">c</span>(<span class="dv">150</span>,<span class="dv">5</span>))</a>
<a class="sourceLine" id="cb99-5" data-line-number="5">  <span class="kw">expect_that</span>(iris<span class="op">$</span>Sepal.Length, <span class="kw">is_a</span>(<span class="st">&quot;numeric&quot;</span>))</a>
<a class="sourceLine" id="cb99-6" data-line-number="6">  <span class="kw">expect_is</span>(iris<span class="op">$</span>Sepal.Length, <span class="st">&quot;numeric&quot;</span>)<span class="co">#equivalent to prev. line</span></a>
<a class="sourceLine" id="cb99-7" data-line-number="7">  <span class="kw">expect_is</span>(iris<span class="op">$</span>Species, <span class="st">&quot;factor&quot;</span>)</a>
<a class="sourceLine" id="cb99-8" data-line-number="8">})</a>
<a class="sourceLine" id="cb99-9" data-line-number="9"></a>
<a class="sourceLine" id="cb99-10" data-line-number="10">iris.color &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Species =</span> <span class="kw">c</span>(<span class="st">&quot;setosa&quot;</span>, <span class="st">&quot;versicolor&quot;</span>, <span class="st">&quot;virginica&quot;</span>),</a>
<a class="sourceLine" id="cb99-11" data-line-number="11">                         <span class="dt">color =</span> <span class="kw">c</span>(<span class="st">&quot;pink&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;orange&quot;</span>))</a>
<a class="sourceLine" id="cb99-12" data-line-number="12"></a>
<a class="sourceLine" id="cb99-13" data-line-number="13">newiris &lt;-<span class="st"> </span><span class="kw">merge</span>(iris, iris.color)</a>
<a class="sourceLine" id="cb99-14" data-line-number="14">iris.model &lt;-<span class="st"> </span><span class="kw">lm</span>(Petal.Length <span class="op">~</span><span class="st"> </span>color, <span class="dt">data =</span> newiris)</a>
<a class="sourceLine" id="cb99-15" data-line-number="15"></a>
<a class="sourceLine" id="cb99-16" data-line-number="16"><span class="kw">test_that</span>(<span class="st">&quot;changes to Iris code occurred as expected&quot;</span>,{</a>
<a class="sourceLine" id="cb99-17" data-line-number="17">  <span class="kw">expect_that</span>(<span class="kw">dim</span>(newiris), <span class="kw">equals</span>(<span class="kw">c</span>(<span class="dv">150</span>, <span class="dv">6</span>)))</a>
<a class="sourceLine" id="cb99-18" data-line-number="18">  <span class="kw">expect_that</span>(<span class="kw">unique</span>(newiris<span class="op">$</span>color),</a>
<a class="sourceLine" id="cb99-19" data-line-number="19">              <span class="kw">is_identical_to</span>(<span class="kw">unique</span>(iris.color<span class="op">$</span>color)))</a>
<a class="sourceLine" id="cb99-20" data-line-number="20">  <span class="kw">expect_equivalent</span>(iris.model<span class="op">$</span>coefficients[<span class="st">&quot;(Intercept)&quot;</span>], <span class="fl">4.26</span>)</a>
<a class="sourceLine" id="cb99-21" data-line-number="21">})</a></code></pre></div>
</div>
<div id="function-testing" class="section level5">
<h5><span class="header-section-number">8.3.5.12.2</span> Function testing</h5>
<p>Testing of a new function, <code>as.sequence</code>. The function and documentation
are in source:R/utils.R and the tests are in source:tests/test.utils.R.</p>
<p>Recently, I made the function <code>as.sequence</code> to turn any vector into a
sequence, with custom handling of NA’s:</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb100-1" data-line-number="1"><span class="cf">function</span>(x, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>){</a>
<a class="sourceLine" id="cb100-2" data-line-number="2">  x2 &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">factor</span>(x, <span class="kw">unique</span>(x)))</a>
<a class="sourceLine" id="cb100-3" data-line-number="3">  <span class="cf">if</span>(<span class="kw">all</span>(<span class="kw">is.na</span>(x2))){</a>
<a class="sourceLine" id="cb100-4" data-line-number="4">    x2 &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span>, <span class="kw">length</span>(x2))</a>
<a class="sourceLine" id="cb100-5" data-line-number="5">  }</a>
<a class="sourceLine" id="cb100-6" data-line-number="6">  <span class="cf">if</span>(na.rm <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span>){</a>
<a class="sourceLine" id="cb100-7" data-line-number="7">    x2[<span class="kw">is.na</span>(x2)] &lt;-<span class="st"> </span><span class="kw">max</span>(x2, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb100-8" data-line-number="8">  }</a>
<a class="sourceLine" id="cb100-9" data-line-number="9">  <span class="kw">return</span>(x2)</a>
<a class="sourceLine" id="cb100-10" data-line-number="10">}</a></code></pre></div>
<p>The next step was to add documentation and test. Many people find it
more efficient to write tests before writing the function. This is true,
but it also requires more discipline. I wrote these tests to handle the
variety of cases that I had observed.</p>
<p>As currently used, the function is exposed to a fairly restricted set of
options - results of downloads from the database and transformations.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb101-1" data-line-number="1"><span class="kw">test_that</span>(“as.sequence works”;{</a>
<a class="sourceLine" id="cb101-2" data-line-number="2"> <span class="kw">expect_identical</span>(<span class="kw">as.sequence</span>(<span class="kw">c</span>(“a”, “b”)), <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb101-3" data-line-number="3"> <span class="kw">expect_identical</span>(<span class="kw">as.sequence</span>(<span class="kw">c</span>(“a”, <span class="ot">NA</span>)), <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb101-4" data-line-number="4"> <span class="kw">expect_equal</span>(<span class="kw">as.sequence</span>(<span class="kw">c</span>(“a”, <span class="ot">NA</span>), <span class="dt">na.rm =</span> <span class="ot">FALSE</span>), <span class="kw">c</span>(<span class="dv">1</span>,<span class="ot">NA</span>))</a>
<a class="sourceLine" id="cb101-5" data-line-number="5"> <span class="kw">expect_equal</span>(<span class="kw">as.sequence</span>(<span class="kw">c</span>(<span class="ot">NA</span>,<span class="ot">NA</span>)), <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb101-6" data-line-number="6">})</a></code></pre></div>
</div>
</div>
<div id="testing-the-shiny-server" class="section level4">
<h4><span class="header-section-number">8.3.5.13</span> Testing the Shiny Server</h4>
<p>Shiny can be difficult to debug because, when run as a web service, the R output is hidden in system log files that are hard to find and read.
One useful approach to debugging is to use port forwarding, as follows.</p>
<p>First, on the remote machine (including the VM), make sure R’s working directory is set to the directory of the Shiny app (e.g., <code>setwd(/path/to/pecan/shiny/WorkflowPlots)</code>, or just open the app as an RStudio project).
Then, in the R console, run the app as:</p>
<pre><code>shiny::runApp(port = XXXX)
# E.g. shiny::runApp(port = 5638)</code></pre>
<p>Then, on your local machine, open a terminal and run the following command, matching <code>XXXX</code> to the port above and <code>YYYY</code> to any unused port on your local machine (any 4-digit number should work).</p>
<pre><code>ssh -L YYYY:localhost:XXXX &lt;remote connection&gt;
# E.g., for the PEcAn VM, given the above port:
# ssh -L 5639:localhost:5638 carya@localhost -p 6422</code></pre>
<p>Now, in a web browser on your local machine, browse to <code>localhost:YYYY</code> (e.g., <code>localhost:5639</code>) to run whatever app you started with <code>shiny::runApp</code> in the previous step.
All of the output should display in the R console where the <code>shiny::runApp</code> command was executed.
Note that this includes any <code>print</code>, <code>message</code>, <code>logger.*</code>, etc. statements in your Shiny app.</p>
<p>If the Shiny app hits an R error, the backtrace should include a line like <code>Hit error at of server.R#LXX</code> – that <code>XX</code> being a line number that you can use to track down the error.
To return from the error to a normal R prompt, hit <code>&lt;Control&gt;-C</code> (alternatively, the “Stop” button in RStudio).
To restart the app, run <code>shiny::runApp(port = XXXX)</code> again (keeping the same port).</p>
<p>Note that Shiny runs any code in the <code>pecan/shiny/&lt;app&gt;</code> directory at the moment the app is launched.
So, any changes you make to the code in <code>server.R</code> and <code>ui.R</code> or scripts loaded therein will take effect the next time the app is started.</p>
<p>If for whatever reason this doesn’t work with RStudio, you can always run R from the command line.
Also, note that the ability to forward ports (<code>ssh -L</code>) may depend on the <code>ssh</code> configuration of your remote machine.
These instructions have been tested on the PEcAn VM (v.1.5.2+).</p>
</div>
<div id="testing-pecan-in-bulk" class="section level4">
<h4><span class="header-section-number">8.3.5.14</span> Testing PEcAn in bulk</h4>
<p>The <a href="https://github.com/pecanproject/pecan/tree/develop/base/workflow/inst/batch_run.R"><code>base/workflow/inst/batch_run.R</code></a> script can be used to quickly run a series of user-specified integration tests without having to create a bunch of XML files.
This script is powered by the <a href=""><code>PEcAn.workflow::create_execute_test_xml()</code></a> function,
which takes as input information about the model, meteorology driver, site ID, run dates, and others,
uses these to construct a PEcAn XML file,
and then uses the <code>system()</code> command to run a workflow with that XML.</p>
<p>If run without arguments, <code>batch_run.R</code> will try to run the model configurations specified in the <a href="https://github.com/pecanproject/pecan/tree/develop/base/workflow/inst/default_tests.csv"><code>base/workflow/inst/default_tests.csv</code></a> file.
This file contains a CSV table with the following columns:</p>
<ul>
<li><code>model</code> – The name of the model (<code>models.model_name</code> column in BETY)</li>
<li><code>revision</code> – The version of the model (<code>models.revision</code> column in BETY)</li>
<li><code>met</code> – The name of the meteorology driver source</li>
<li><code>site_id</code> – The numeric site ID for the model run (<code>sites.site_id</code>)</li>
<li><code>pft</code> – The name of the plant functional type to run. If <code>NA</code>, the script will use the first PFT associated with the model.</li>
<li><code>start_date</code>, <code>end_date</code> – The start and end dates for the model run, respectively. These should be formatted according to ISO standard (<code>YYYY-MM-DD</code>, e.g. <code>2010-03-16</code>)</li>
<li><code>sensitivity</code> – Whether or not to run the sensitivity analysis. <code>TRUE</code> means run it, <code>FALSE</code> means do not.</li>
<li><code>ensemble_size</code> – The number of ensemble members to run. Set this to 1 to do a single run at the trait median.</li>
<li><code>comment</code> – An string providing some user-friendly information about the run.</li>
</ul>
<p>The <code>batch_run.R</code> script will run a workflow for every row in the input table, sequentially (for now; eventually, it will try to run them in parallel),
and at the end of each workflow, will perform some basic checks, including whether or not the workflow finished and if the model produced any output.
These results are summarized in a CSV table (by default, a file called <code>test_result_table.csv</code>), with all of the columns as the input test CSV plus the following:</p>
<ul>
<li><code>outdir</code> – Absolute path to the workflow directory.</li>
<li><code>workflow_complete</code> – Whether or not the PEcAn workflow completed. Note that this is a relatively low bar – PEcAn workflows can complete without having run the model or finished some other steps.</li>
<li><code>has_jobsh</code> – Whether or not PEcAn was able to write the model’s <code>job.sh</code> script. This is a good indication of whether or not the model’s <code>write.configs</code> step was successful, and may be useful for separating model configuration errors from model execution errors.</li>
<li><code>model_output_raw</code> – Whether or not the model produced any output files at all. This is just a check to see of the <code>&lt;workflow&gt;/out</code> directory is empty or not. Note that some models may produce logfiles or similar artifacts as soon as they are executed, whether or not they ran even a single timestep, so this is not an indication of model success.</li>
<li><code>model_output_processed</code> – Whether or not PEcAn was able to post-process any model output. This test just sees if there are any files of the form <code>YYYY.nc</code> (e.g. <code>1992.nc</code>) in the <code>&lt;workflow&gt;/out</code> directory.</li>
</ul>
<p>Right now, these checks are not particularly robust or comprehensive, but they should be sufficient for catching common errors.
Development of more, better tests is ongoing.</p>
<p>The <code>batch_run.R</code> script can take the following command-line arguments:</p>
<ul>
<li><code>--help</code> – Prints a help message about the script’s arguments</li>
<li><code>--dbfiles=&lt;path&gt;</code> – The path to the PEcAn <code>dbfiles</code> folder. The default value is <code>~/output/dbfiles</code>, based on the file structure of the PEcAn VM. Note that for this and all other paths, if a relative path is given, it is assumed to be relative to the current working directory, i.e. the directory from which the script was called.</li>
<li><code>--table=&lt;path&gt;</code> – Path to an alternate test table. The default is the <code>base/workflow/inst/default_tests.csv</code> file. See preceding paragraph for a description of the format.</li>
<li><code>--userid=&lt;id&gt;</code> – The numeric user ID for registering the workflow. The default value is 99000000002, corresponding to the guest user on the PEcAn VM.</li>
<li><code>--outdir=&lt;path&gt;</code> – Path to a directory (which will be created if it doesn’t exist) for storing the PEcAn workflow outputs. Default is <code>batch_test_output</code> (in the current working directory).</li>
<li><code>--pecandir=&lt;path&gt;</code> – Path to the PEcAn source code root directory. Default is the current working directory.</li>
<li><code>--outfile=&lt;path&gt;</code> – Full path (including file name) of the CSV file summarizing the results of the runs. Default is <code>test_result_table.csv</code>. The format of the output</li>
</ul>

</div>
</div>
<div id="developer-devtools" class="section level3">
<h3><span class="header-section-number">8.3.6</span> <code>devtools</code> package</h3>
<p>Provides functions to simplify development</p>
<p>Documentation:
<a href="https://github.com/hadley/devtools">The R devtools packate</a></p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb104-1" data-line-number="1"><span class="kw">load_all</span>(<span class="st">&quot;pkg&quot;</span>)</a>
<a class="sourceLine" id="cb104-2" data-line-number="2"><span class="kw">document</span>(<span class="st">&quot;pkg&quot;</span>)</a>
<a class="sourceLine" id="cb104-3" data-line-number="3"><span class="kw">test</span>(<span class="st">&quot;pkg&quot;</span>)</a>
<a class="sourceLine" id="cb104-4" data-line-number="4"><span class="kw">install</span>(<span class="st">&quot;pkg&quot;</span>)</a>
<a class="sourceLine" id="cb104-5" data-line-number="5"><span class="kw">build</span>(<span class="st">&quot;pkg&quot;</span>)</a></code></pre></div>
<p>other tips for devtools (from the documentation):</p>
<ul>
<li>Adding the following to your <code>~/.Rprofile</code> will load devtools when
running R in interactive mode:</li>
</ul>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb105-1" data-line-number="1"><span class="co"># load devtools by default</span></a>
<a class="sourceLine" id="cb105-2" data-line-number="2"><span class="cf">if</span> (<span class="kw">interactive</span>()) {</a>
<a class="sourceLine" id="cb105-3" data-line-number="3">  <span class="kw">suppressMessages</span>(<span class="kw">require</span>(devtools))</a>
<a class="sourceLine" id="cb105-4" data-line-number="4">}</a></code></pre></div>
<ul>
<li>Adding the following to your .Rpackages will allow devtools to recognize package by folder name, rather than directory path</li>
</ul>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb106-1" data-line-number="1"><span class="co"># in this example, devhome is the pecan trunk directory </span></a>
<a class="sourceLine" id="cb106-2" data-line-number="2">devhome &lt;-<span class="st"> &quot;/home/dlebauer/R-dev/pecandev/&quot;</span></a>
<a class="sourceLine" id="cb106-3" data-line-number="3"><span class="kw">list</span>(</a>
<a class="sourceLine" id="cb106-4" data-line-number="4">    <span class="dt">default =</span> <span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb106-5" data-line-number="5">      <span class="kw">file.path</span>(devhome, x, x)</a>
<a class="sourceLine" id="cb106-6" data-line-number="6">    }, </a>
<a class="sourceLine" id="cb106-7" data-line-number="7">  <span class="st">&quot;utils&quot;</span> =<span class="st"> </span><span class="kw">paste</span>(devhome, <span class="st">&quot;pecandev/utils&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb106-8" data-line-number="8">  <span class="st">&quot;common&quot;</span> =<span class="st"> </span><span class="kw">paste</span>(devhome, <span class="st">&quot;pecandev/common&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb106-9" data-line-number="9">  <span class="st">&quot;all&quot;</span> =<span class="st"> </span><span class="kw">paste</span>(devhome, <span class="st">&quot;pecandev/all&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb106-10" data-line-number="10">  <span class="st">&quot;ed&quot;</span> =<span class="st"> </span><span class="kw">paste</span>(devhome, <span class="st">&quot;pecandev/models/ed&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb106-11" data-line-number="11">  <span class="st">&quot;uncertainty&quot;</span> =<span class="st"> </span><span class="kw">paste</span>(devhome, <span class="st">&quot;modules/uncertainty&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb106-12" data-line-number="12">  <span class="st">&quot;meta.analysis&quot;</span> =<span class="st"> </span><span class="kw">paste</span>(devhome, <span class="st">&quot;modules/meta.analysis&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb106-13" data-line-number="13">  <span class="st">&quot;db&quot;</span> =<span class="st"> </span><span class="kw">paste</span>(devhome, <span class="st">&quot;db&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb106-14" data-line-number="14">)</a></code></pre></div>
<p>Now, devtools can take <code>pkg</code> as an argument instead of <code>/path/to/pkg/</code>,
e.g. so you can use <code>build(&quot;pkg&quot;)</code> instead of <code>build(&quot;/path/to/pkg/&quot;)</code></p>

</div>
</div>
<div id="download-and-compile-pecan" class="section level2">
<h2><span class="header-section-number">8.4</span> Download and Compile PEcAn</h2>
<p>Set <code>R_LIBS_USER</code></p>
<p><a href="http://cran.r-project.org/doc/manuals/r-devel/R-admin.html#Managing-libraries">CRAN Reference</a></p>
<div class="sourceCode" id="cb107"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb107-1" data-line-number="1"><span class="co"># point R to personal lib folder</span></a>
<a class="sourceLine" id="cb107-2" data-line-number="2"><span class="bu">echo</span> <span class="st">&#39;export R_LIBS_USER=${HOME}/R/library&#39;</span> <span class="op">&gt;&gt;</span> ~/.profile</a>
<a class="sourceLine" id="cb107-3" data-line-number="3"><span class="bu">source</span> ~/.profile</a>
<a class="sourceLine" id="cb107-4" data-line-number="4"><span class="fu">mkdir</span> -p <span class="va">${R_LIBS_USER}</span></a></code></pre></div>
<div id="download-compile-and-install-pecan-from-github" class="section level3">
<h3><span class="header-section-number">8.4.1</span> Download, compile and install PEcAn from GitHub</h3>
<div class="sourceCode" id="cb108"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb108-1" data-line-number="1"><span class="co"># download pecan</span></a>
<a class="sourceLine" id="cb108-2" data-line-number="2"><span class="bu">cd</span></a>
<a class="sourceLine" id="cb108-3" data-line-number="3"><span class="fu">git</span> clone https://github.com/PecanProject/pecan.git</a>
<a class="sourceLine" id="cb108-4" data-line-number="4"></a>
<a class="sourceLine" id="cb108-5" data-line-number="5"><span class="co"># compile pecan</span></a>
<a class="sourceLine" id="cb108-6" data-line-number="6"><span class="bu">cd</span> pecan</a>
<a class="sourceLine" id="cb108-7" data-line-number="7"><span class="fu">make</span></a></code></pre></div>
<p>For more information on the capabilities of the PEcAn Makefile, check out our section on <a href="developer-guide.html#pecan-make">Updating PEcAn</a>.</p>
<p>Following will run a small script to setup some hooks to prevent people from using the pecan demo user account to check in any code.</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb109-1" data-line-number="1"><span class="co"># prevent pecan user from checking in code</span></a>
<a class="sourceLine" id="cb109-2" data-line-number="2"><span class="ex">./scripts/create-hooks.sh</span></a></code></pre></div>
</div>
<div id="pecan-testrun" class="section level3">
<h3><span class="header-section-number">8.4.2</span> PEcAn Testrun</h3>
<p>Do the run, this assumes you have <a href="workflow-modules.html#install-bety">installed the BETY database</a>, <a href="workflow-modules.html#site-information">sites</a> tar file and <a href="pecan-models.html#models-sipnet">SIPNET</a>.</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb110-1" data-line-number="1"><span class="co"># create folder</span></a>
<a class="sourceLine" id="cb110-2" data-line-number="2"><span class="bu">cd</span></a>
<a class="sourceLine" id="cb110-3" data-line-number="3"><span class="fu">mkdir</span> testrun.pecan</a>
<a class="sourceLine" id="cb110-4" data-line-number="4"><span class="bu">cd</span> testrun.pecan</a>
<a class="sourceLine" id="cb110-5" data-line-number="5"></a>
<a class="sourceLine" id="cb110-6" data-line-number="6"><span class="co"># copy example of pecan workflow and configuration file</span></a>
<a class="sourceLine" id="cb110-7" data-line-number="7"><span class="fu">cp</span> ../pecan/tests/pecan32.sipnet.xml pecan.xml</a>
<a class="sourceLine" id="cb110-8" data-line-number="8"><span class="fu">cp</span> ../pecan/scripts/workflow.R workflow.R</a>
<a class="sourceLine" id="cb110-9" data-line-number="9"></a>
<a class="sourceLine" id="cb110-10" data-line-number="10"><span class="co"># exectute workflow</span></a>
<a class="sourceLine" id="cb110-11" data-line-number="11"><span class="fu">rm</span> -rf pecan</a>
<a class="sourceLine" id="cb110-12" data-line-number="12"><span class="ex">./workflow.R</span> pecan.xml</a></code></pre></div>
<p>NB: pecan.xml is configured for the virtual machine, you will need to change the <met> field from ‘/home/carya/’ to wherever you installed your ‘sites’, usually $HOME</p>

</div>
</div>
<div id="directory-structure" class="section level2">
<h2><span class="header-section-number">8.5</span> Directory structure</h2>
<div id="overview-of-pecan-repository-as-of-pecan-1.5.3" class="section level3">
<h3><span class="header-section-number">8.5.1</span> Overview of PEcAn repository as of PEcAn 1.5.3</h3>
<!--Should Also include a guideline to structures so that people know where to put things as they add them-->
<pre><code>pecan/
 +- base/          # Core functions
    +- all         # Dummy package to load all PEcAn R packages
    +- db          # Modules for querying the database
    +- logger      # Report warnings without killing workflows
    +- qaqc        # Model skill testing and integration testing
    +- remote      # Communicate with and execute models on local and remote hosts
    +- settings    # Functions to read and manipulate PEcAn settings files
    +- utils       # Misc. utility functions
    +- visualization # Advanced PEcAn visualization module
    +- workflow    # functions to coordinate analysis steps
 +- book_source/   # Main documentation and developer&#39;s guide
 +- CHANGELOG.md   # Running log of changes in each version of PEcAn
 +- docker/        # Experimental replacement for PEcAn virtual machine
 +- documentation  # index_vm.html, references, other misc.
 +- models/        # Wrappers to run models within PEcAn
    +- ed/         # Wrapper scripts for running ED within PEcAn
    +- sipnet/     # Wrapper scripts for running SIPNET within PEcAn
    +- ...         # Wrapper scripts for running [...] within PEcAn
    +- template/   # Sample wrappers to copy and modify when adding a new model
 +- modules        # Core modules
    +- allometry
    +- data.atmosphere
    +- data.hydrology
    +- data.land
    +- meta.analysis
    +- priors
    +- rtm
    +- uncertainty
    +- ...
 +- scripts        # R and Shell scripts for use with PEcAn
 +- shiny/         # Interactive visualization of model results
 +- tests/         # Settings files for host-specific integration tests
 +- web            # Main PEcAn website files</code></pre>
</div>
<div id="generic-r-package-structure" class="section level3">
<h3><span class="header-section-number">8.5.2</span> Generic R package structure:</h3>
<p>see the R development wiki for more information on writing code and adding data.</p>
<pre><code> +- DESCRIPTION    # short description of the PEcAn library
 +- R/             # location of R source code
 +- man/           # Documentation (automatically compiled by Roxygen)
 +- inst/          # files to be installed with package that aren&#39;t R functions
    +- extdata/    # misc. data files (in misc. formats)
 +- data/          # data used in testing and examples (saved as *.RData or *.rda files)
 +- NAMESPACE      # declaration of package imports and exports (automatically compiled by Roxygen)
 +- tests/         # PEcAn testing scripts
   +- testthat/    # nearly all tests should use the testthat framework and live here</code></pre>

</div>
</div>
</div>



</div>
            </section>

          </div>
        </div>
      </div>
<a href="intermediate-user.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="working-with-vm.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/tonygardella/pecan/edit/release/vtonydoc/book_source/02_demos_tutorials_workflows/05_developer_workflows/00_developer_guide.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
